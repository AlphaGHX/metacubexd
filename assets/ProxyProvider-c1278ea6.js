import{ae as Y,h as g,i,c as l,S as M,b as $,f as A,af as z,j as L,F as W,l as Q,t as T,d as F,G as V,u as X,ag as H,ad as q}from"./vendor-a313f5e6.js";import{l as J,P as K,m as D,n as N,i as B,o as x,L as R,B as I,j as Z,p as ee,h as te,k as ne}from"./index-f24519d7.js";import{u as O}from"./global-bddbc16e.js";const le=$('<div class="ml-2 flex flex-1 flex-col">'),re=$('<div class="flex"><div class="flex flex-1 flex-col">'),se=e=>{const n=Y(),t=g(()=>n.width>=640&&J()),s=g(()=>e.subChild.filter((a,c)=>c%2===0||!t())),r=g(()=>e.subChild.filter((a,c)=>c%2===1));return(()=>{const a=re(),c=a.firstChild;return i(c,s),i(a,l(M,{get when(){return t()},get children(){const _=le();return i(_,r),_}}),null),a})()},ae=e=>{const[n,t]=A(100),s=g(()=>e.proxyNames.slice(0,n()));return l(z,{get each(){return s()},get hasMore(){return s().length<e.proxyNames.length},next:()=>t(n()+30),children:r=>l(K,{proxyName:r,get isSelected(){return e.now===r},onClick:()=>{var a;(a=e.onClick)==null||a.call(e,r)}})})},ie=e=>{const n=()=>D()===N.OFF,t=g(()=>e.proxyNameList.length<=30),s=g(()=>{const a=D();return a===N.BAR||a===N.Auto&&!t()}),r=g(()=>{const a=D();return a===N.DOTS||a===N.Auto&&t()});return l(M,{get when(){return!n()},get children(){return[l(M,{get when(){return s()},get children(){return l(ce,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),l(M,{get when(){return r()},get children(){return l(me,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},oe=$('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),ce=e=>{const{latencyMap:n}=B(),t=g(()=>e.proxyNameList.map(o=>n()[o])),s=g(()=>t().length),r=g(()=>t().filter(o=>o>x().NOT_CONNECTED&&o<=x().MEDIUM).length),a=g(()=>t().filter(o=>o>x().MEDIUM&&o<=x().HIGH).length),c=g(()=>t().filter(o=>o>x().HIGH).length),_=g(()=>t().filter(o=>o===x().NOT_CONNECTED).length);return(()=>{const o=oe(),E=o.firstChild,y=E.firstChild,w=y.nextSibling,b=w.nextSibling,p=b.nextSibling;return i(o,l(R,{get name(){return e.now}}),null),L(f=>{const v=`${r()*100/s()}%`,C=`${a()*100/s()}%`,u=`${c()*100/s()}%`,m=`${_()*100/s()}%`;return v!==f._v$&&((f._v$=v)!=null?y.style.setProperty("width",v):y.style.removeProperty("width")),C!==f._v$2&&((f._v$2=C)!=null?w.style.setProperty("width",C):w.style.removeProperty("width")),u!==f._v$3&&((f._v$3=u)!=null?b.style.setProperty("width",u):b.style.removeProperty("width")),m!==f._v$4&&((f._v$4=m)!=null?p.style.setProperty("width",m):p.style.removeProperty("width")),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),o})()},de=$("<div>"),ue=$('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),ge=e=>{let n=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===x().NOT_CONNECTED?n=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>x().HIGH?n=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>x().MEDIUM&&(n=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const t=de();return L(()=>Q(t,T("m-1 h-4 w-4 rounded-full",n))),t})()},me=e=>{const{latencyMap:n}=B();return(()=>{const t=ue(),s=t.firstChild;return i(s,l(W,{get each(){return e.proxyNameList.map(r=>[r,n()[r]])},children:([r,a])=>{const c=e.now===r;return l(ge,{latency:a,selected:c})}})),i(t,l(R,{get name(){return e.now}}),null),t})()},he=$('<progress class="progress" max="100">'),fe=$('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),$e=$('<div class="text-sm text-slate-500">Expire: <!> '),xe=e=>{const n=F(e.Total,{units:"iec"}),t=F(e.Download+e.Upload,{units:"iec"}),s=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:n,used:t,percentage:s,expireStr:()=>e.Expire===0?"Null":V(e.Expire*1e3).format("YYYY-MM-DD")}},_e=e=>{if(!e.subscriptionInfo)return;const n=xe(e.subscriptionInfo);return[(()=>{const t=he();return L(()=>t.value=n.percentage),t})(),(()=>{const t=fe(),s=t.firstChild,r=s.nextSibling,a=r.nextSibling,c=a.nextSibling;return c.nextSibling,i(t,()=>`${n.used}`,s),i(t,()=>`${n.total}`,r),i(t,()=>n.percentage,c),t})(),(()=>{const t=$e(),s=t.firstChild,r=s.nextSibling;return r.nextSibling,i(t,()=>n.expireStr(),r),t})()]},ye=$('<div class="flex flex-col gap-2"><h1 class="flex h-8 items-center pb-2 text-lg font-semibold">'),we=$('<div class="mr-8 flex items-center justify-between"><span></span><div>'),be=$('<div class="text-sm text-slate-500"> :: <!> '),pe=()=>{const[e]=X(),{proxyProviders:n,updateProviderByProviderName:t,updateAllProvider:s,healthCheckByProviderName:r,latencyMap:a}=B(),{map:c,set:_}=O(),{map:o,setWithCallback:E}=O(),{map:y,setWithCallback:w}=O(),[b,p]=A(!1),f=async(u,m)=>{u.stopPropagation(),E(m,async()=>await r(m))},v=async(u,m)=>{u.stopPropagation(),w(m,async()=>await t(m))},C=async u=>{u.stopPropagation(),p(!0);try{await s()}catch{}p(!1)};return(()=>{const u=ye(),m=u.firstChild;return i(m,()=>e("proxyProviders"),null),i(m,l(I,{class:"btn-circle btn-ghost btn-sm ml-2",onClick:d=>C(d),get children(){return l(H,{get class(){return T(b()&&"animate-spin")}})}}),null),i(u,l(se,{get subChild(){return n().map(d=>{const U=Z(d.proxies.map(h=>h.name)??[],a(),ee()),j=[(()=>{const h=we(),S=h.firstChild,P=S.nextSibling;return i(S,()=>d.name),i(P,l(I,{class:"btn btn-circle btn-sm mr-2",onClick:k=>v(k,d.name),get children(){return l(H,{get class(){return T(y()[d.name]&&"animate-spin")}})}}),null),i(P,l(I,{class:"btn btn-circle btn-sm",onClick:k=>f(k,d.name),get children(){return l(q,{get class(){return T(o()[d.name]&&"animate-pulse")}})}}),null),h})(),l(_e,{get subscriptionInfo(){return d.subscriptionInfo}}),(()=>{const h=be(),S=h.firstChild,P=S.nextSibling;return P.nextSibling,i(h,()=>d.vehicleType,S),i(h,()=>e("updated"),P),i(h,()=>te(d.updatedAt),null),h})(),l(M,{get when(){return!c()[`provider-${d.name}`]},get children(){return l(ie,{proxyNameList:U})}})],G=l(ae,{proxyNames:U});return l(ne,{get isOpen(){return c()[`provider-${d.name}`]},title:j,content:G,onCollapse:h=>_(`provider-${d.name}`,h)})})}}),null),u})()},Pe=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{se as F,ie as P,ae as a,pe as b,Pe as c};
