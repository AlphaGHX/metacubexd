import{i,r as F,T as _,d as S,t as y,c as v,J as G,s as J,p as R,b as g,X,F as b}from"./vendor-e7ea9428.js";import{t as w}from"./tw-merge-1166cefb.js";import{u as z}from"./index-a69b8eca.js";const H=y('<div><div class="collapse-title text-xl font-medium"></div><div>'),K=r=>{const{title:p,content:f,onCollapse:x}=r,c=()=>{const s="collapse-open",o="collapse-close";return r.isOpen?s:o},l=()=>{const s="opacity-100",o="opacity-0";return r.isOpen?s:o};return(()=>{const s=H(),o=s.firstChild,n=o.nextSibling;return o.$$click=()=>x(!r.isOpen),i(o,p),i(n,f),F(e=>{const t=w(c(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),u=w(l(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return t!==e._v$&&_(s,e._v$=t),u!==e._v$2&&_(n,e._v$2=u),e},{_v$:void 0,_v$2:void 0}),s})()},k=K;S(["click"]);const[Q,U]=v([]),[V,W]=v([]),[N,B]=v({}),[T,Y]=v({});function A(){const r=z(),p=async()=>{const{providers:c}=await r.get("providers/proxies").json(),l=N();Object.values(c).forEach(n=>{n.proxies.forEach(e=>{var t;Y({...T(),[e.name]:e}),l[e.name]=(t=e.history[e.history.length-1])==null?void 0:t.delay})}),B(l),W(Object.values(c).filter(n=>n.name!=="default"&&n.vehicleType!=="Compatible"));const{proxies:s}=await r.get("proxies").json(),o=s.GLOBAL.all??[];U(Object.values(s).filter(n=>n.all&&n.all.length>0).sort((n,e)=>o.indexOf(n.name)-o.indexOf(e.name)))};return{proxies:Q,proxyProviders:V,delayTestByProxyGroupName:async c=>{const l=await r.get(`group/${c}/delay?url=https%3A%2F%2Fwww.gstatic.com%2Fgenerate_204&timeout=2000`).json(),s=N();Object.entries(l).forEach(([o,n])=>{s[o]=n}),B({...s})},proxyNodeMap:T,delayMap:N,updateProxy:p,setProxiesByProxyName:async(c,l)=>{await r.put(`proxies/${c.name}`,{body:JSON.stringify({name:l})}),await p()}}}const Z=y("<span>ms"),ee=y('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div class="truncate text-xs text-slate-500"></div><div class="text-xs">'),E=r=>{const{proxyName:p,isSelected:f,onClick:x}=r,{delayMap:c,proxyNodeMap:l}=A(),s=G(()=>l()[p]),o=e=>{const t=c()[e];if(typeof t!="number"||t===0)return"";let u="text-green-500";return t>500?u="text-red-500":t>200&&(u="text-yellow-500"),(()=>{const m=Z(),$=m.firstChild;return _(m,u),i(m,t,$),m})()},n=e=>{const t=e.toLowerCase();return t==="shadowsocks"?"ss":t};return(()=>{const e=ee(),t=e.firstChild,u=t.nextSibling,m=u.firstChild,$=m.nextSibling;return e.$$click=()=>x==null?void 0:x(),J(e,"data-tip",p),i(t,p),i(m,()=>n(s().type),null),i(m,()=>s().udp?" :: udp":"",null),i($,()=>o(p)),F(()=>_(e,w("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 p-4",f?"border-primary bg-success-content text-success":"border-secondary",x&&"cursor-pointer"))),e})()};S(["click"]);const te=y('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2"></div></div><div><h1 class="pb-4 text-lg font-semibold">Proxy Providers</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),se=y('<div class="flex items-center justify-between"><div class="flex flex-col"><span></span><div class="text-sm text-slate-500"> :: </div></div><button class="btn btn-circle btn-sm">'),ae=()=>{const{proxies:r,proxyProviders:p,updateProxy:f,setProxiesByProxyName:x,delayTestByProxyGroupName:c}=A(),[l,s]=v({});R(async()=>{await f()});const o=async(e,t)=>{x(e,t)},n=(e,t)=>{e.stopPropagation(),c(t)};return(()=>{const e=te(),t=e.firstChild,u=t.firstChild,m=u.nextSibling,$=t.nextSibling,L=$.firstChild,q=L.nextSibling;return i(m,g(b,{get each(){return r()},children:a=>{const h=(()=>{const d=se(),O=d.firstChild,M=O.firstChild,P=M.nextSibling,D=P.firstChild,j=O.nextSibling;return i(M,()=>a.name),i(P,()=>a.type,D),i(P,()=>a.now,null),j.$$click=I=>n(I,a.name),i(j,g(X,{})),d})(),C=g(b,{get each(){return a.all},children:d=>g(E,{proxyName:d,get isSelected(){return a.now===d},onClick:()=>o(a,d)})});return g(k,{get isOpen(){return l()[`group-${a.name}`]},title:h,content:C,onCollapse:d=>s({...l(),[`group-${a.name}`]:d})})}})),i(q,g(b,{get each(){return p()},children:a=>{const h=G(()=>a.name),C=g(b,{get each(){return a.proxies},children:d=>g(E,{get proxyName(){return d.name}})});return g(k,{get isOpen(){return l()[`provider-${a.name}`]},title:h,content:C,onCollapse:d=>s({...l(),[`provider-${a.name}`]:d})})}})),e})()};S(["click"]);export{ae as default};
