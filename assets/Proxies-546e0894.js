import{ad as ge,e as $,i as s,g as n,S as _,l as u,c as Y,ae as me,h as G,F as se,j as re,t as L,b as X,z as he,u as $e,af as q,ag as J,f as xe}from"./vendor-9d884d62.js";import{B as H}from"./Button-2f123a88.js";import{r as fe,P as pe,p as W,j as B,k as z,l as v,L as ae,m as K,n as Z,h as be,o as ee}from"./index-1b6fb9bf.js";import{u as F}from"./global-c5bd22bb.js";const _e=u('<div class="ml-2 flex flex-1 flex-col">'),ve=u('<div class="flex"><div class="flex flex-1 flex-col">'),te=e=>{const a=ge(),t=$(()=>a.width>=640&&fe()),o=$(()=>e.subChild.filter((c,g)=>g%2===0||!t())),i=$(()=>e.subChild.filter((c,g)=>g%2===1));return(()=>{const c=ve(),g=c.firstChild;return s(g,o),s(c,n(_,{get when(){return t()},get children(){const S=_e();return s(S,i),S}}),null),c})()},ne=e=>{const[a,t]=Y(100),o=$(()=>e.proxyNames.slice(0,a()));return n(me,{get each(){return o()},get hasMore(){return o().length<e.proxyNames.length},next:()=>t(a()+30),children:i=>n(pe,{proxyName:i,get isSelected(){return e.now===i},get onClick(){return e.onClick&&(()=>{var c;return(c=e.onClick)==null?void 0:c.call(e,i)})}})})},le=e=>{const a=()=>W()===B.OFF,t=$(()=>e.proxyNameList.length<=30),o=$(()=>{const c=W();return c===B.BAR||c===B.Auto&&!t()}),i=$(()=>{const c=W();return c===B.DOTS||c===B.Auto&&t()});return n(_,{get when(){return!a()},get children(){return[n(_,{get when(){return o()},get children(){return n(ye,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),n(_,{get when(){return i()},get children(){return n(Pe,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},we=u('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),ye=e=>{const{latencyMap:a}=z(),t=$(()=>e.proxyNameList.map(d=>a()[d])),o=$(()=>t().length),i=$(()=>t().filter(d=>d>v().NOT_CONNECTED&&d<=v().MEDIUM).length),c=$(()=>t().filter(d=>d>v().MEDIUM&&d<=v().HIGH).length),g=$(()=>t().filter(d=>d>v().HIGH).length),S=$(()=>t().filter(d=>d===v().NOT_CONNECTED).length);return(()=>{const d=we(),P=d.firstChild,M=P.firstChild,k=M.nextSibling,D=k.nextSibling,U=D.nextSibling;return s(d,n(ae,{get name(){return e.now}}),null),G(x=>{const T=`${i()*100/o()}%`,I=`${c()*100/o()}%`,E=`${g()*100/o()}%`,O=`${S()*100/o()}%`;return T!==x._v$&&((x._v$=T)!=null?M.style.setProperty("width",T):M.style.removeProperty("width")),I!==x._v$2&&((x._v$2=I)!=null?k.style.setProperty("width",I):k.style.removeProperty("width")),E!==x._v$3&&((x._v$3=E)!=null?D.style.setProperty("width",E):D.style.removeProperty("width")),O!==x._v$4&&((x._v$4=O)!=null?U.style.setProperty("width",O):U.style.removeProperty("width")),x},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()},Ce=u("<div>"),Ne=u('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),Se=e=>{let a=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===v().NOT_CONNECTED?a=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>v().HIGH?a=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>v().MEDIUM&&(a=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const t=Ce();return G(()=>re(t,L("m-1 h-4 w-4 rounded-full",a))),t})()},Pe=e=>{const{latencyMap:a}=z();return(()=>{const t=Ne(),o=t.firstChild;return s(o,n(se,{get each(){return e.proxyNameList.map(i=>[i,a()[i]])},children:([i,c])=>{const g=e.now===i;return n(Se,{latency:c,selected:g})}})),s(t,n(ae,{get name(){return e.now}}),null),t})()},Me=u('<progress class="progress" max="100">'),ke=u('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Te=u('<div class="text-sm text-slate-500">Expire: <!> '),Ee=e=>{const a=X(e.Total,{units:"iec"}),t=X(e.Download+e.Upload,{units:"iec"}),o=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:a,used:t,percentage:o,expireStr:()=>e.Expire===0?"Null":he(e.Expire*1e3).format("YYYY-MM-DD")}},Le=e=>{if(!e.subscriptionInfo)return;const a=Ee(e.subscriptionInfo);return[(()=>{const t=Me();return G(()=>t.value=a.percentage),t})(),(()=>{const t=ke(),o=t.firstChild,i=o.nextSibling,c=i.nextSibling,g=c.nextSibling;return g.nextSibling,s(t,()=>`${a.used}`,o),s(t,()=>`${a.total}`,i),s(t,()=>a.percentage,g),t})(),(()=>{const t=Te(),o=t.firstChild,i=o.nextSibling;return i.nextSibling,s(t,()=>a.expireStr(),i),t})()]},De=u('<div class="flex items-center gap-2"><div class="tabs tabs-boxed gap-2">'),Ie=u('<div class="flex h-full flex-col gap-2"><div class="flex-1 overflow-y-auto">'),Oe=u('<button><span></span><div class="badge badge-sm">'),Be=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div>'),Ue=u('<div class="text-sm text-slate-500"> :: <!> '),Ae=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),He=u('<div class="text-sm text-slate-500"> ');var N=function(e){return e.proxyProviders="proxyProviders",e.proxies="proxies",e}(N||{});const We=()=>{const[e]=$e(),{proxies:a,setProxyGroupByProxyName:t,latencyTestByProxyGroupName:o,latencyMap:i,proxyProviders:c,updateProviderByProviderName:g,updateAllProvider:S,healthCheckByProviderName:d}=z(),{map:P,set:M}=F(),{map:k,setWithCallback:D}=F(),U=async(h,m)=>{t(h,m)},x=async(h,m)=>{h.stopPropagation(),D(m,()=>o(m))},{map:T,setWithCallback:I}=F(),{map:E,setWithCallback:O}=F(),[Q,V]=Y(!1),ie=(h,m)=>{h.stopPropagation(),I(m,()=>d(m))},ce=(h,m)=>{h.stopPropagation(),O(m,()=>g(m))},oe=async h=>{h.stopPropagation(),V(!0);try{await S()}catch{}V(!1)},[A,de]=Y(N.proxies),ue=()=>[{type:N.proxies,name:e("proxies"),count:a().length},{type:N.proxyProviders,name:e("proxyProviders"),count:c().length}];return(()=>{const h=Ie(),m=h.firstChild;return s(h,n(_,{get when(){return c().length>0},get children(){const l=De(),y=l.firstChild;return s(y,n(se,{get each(){return ue()},children:b=>(()=>{const w=Oe(),r=w.firstChild,f=r.nextSibling;return w.$$click=()=>de(b.type),s(r,()=>b.name),s(f,()=>b.count),G(()=>re(w,L(A()===b.type&&"tab-active","tab gap-2 px-2"))),w})()})),s(l,n(_,{get when(){return A()===N.proxyProviders},get children(){return n(H,{class:"btn btn-circle btn-sm",get disabled(){return Q()},onClick:b=>oe(b),get children(){return n(q,{get class(){return L(Q()&&"animate-spin text-success")}})}})}}),null),l}}),m),s(m,n(_,{get when(){return A()===N.proxyProviders},get children(){return n(te,{get subChild(){return c().map(l=>{const y=K(l.proxies.map(r=>r.name)??[],i(),Z()),b=[(()=>{const r=Be(),f=r.firstChild,p=f.firstChild,R=p.nextSibling,C=f.nextSibling;return s(p,()=>l.name),s(R,()=>l.proxies.length),s(C,n(H,{class:"btn btn-circle btn-sm mr-2",get disabled(){return E()[l.name]},onClick:j=>ce(j,l.name),get children(){return n(q,{get class(){return L(E()[l.name]&&"animate-spin text-success")}})}}),null),s(C,n(H,{class:"btn btn-circle btn-sm",get disabled(){return T()[l.name]},onClick:j=>ie(j,l.name),get children(){return n(J,{get class(){return L(T()[l.name]&&"animate-pulse text-success")}})}}),null),r})(),n(Le,{get subscriptionInfo(){return l.subscriptionInfo}}),(()=>{const r=Ue(),f=r.firstChild,p=f.nextSibling;return p.nextSibling,s(r,()=>l.vehicleType,f),s(r,()=>e("updated"),p),s(r,()=>be(l.updatedAt),null),r})(),n(_,{get when(){return!P()[l.name]},get children(){return n(le,{proxyNameList:y})}})],w=n(ne,{proxyNames:y});return n(ee,{get isOpen(){return P()[l.name]},title:b,content:w,onCollapse:r=>M(l.name,r)})})}})}}),null),s(m,n(_,{get when(){return A()===N.proxies},get children(){return n(te,{get subChild(){return a().map(l=>{const y=K(l.all??[],i(),Z()),b=[(()=>{const r=Ae(),f=r.firstChild,p=f.firstChild,R=p.nextSibling;return s(p,()=>l.name),s(R,()=>{var C;return(C=l.all)==null?void 0:C.length}),s(r,n(H,{class:"btn-circle btn-sm",get disabled(){return k()[l.name]},onClick:C=>x(C,l.name),get children(){return n(J,{get class(){return L(k()[l.name]&&"animate-pulse text-success")}})}}),null),r})(),(()=>{const r=He(),f=r.firstChild;return s(r,()=>l.type,f),s(r,()=>{var p;return((p=l.now)==null?void 0:p.length)>0&&` :: ${l.now}`},null),r})(),n(_,{get when(){return!P()[l.name]},get children(){return n(le,{proxyNameList:y,get now(){return l.now}})}})],w=n(ne,{proxyNames:y,get now(){return l.now},onClick:r=>{U(l,r)}});return n(ee,{get isOpen(){return P()[l.name]},title:b,content:w,onCollapse:r=>M(l.name,r)})})}})}}),null),h})()};xe(["click"]);export{We as default};
