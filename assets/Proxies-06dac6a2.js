import{i as b,b as k,S as ne,f as re,t as K,g as Z,d as ae,h as B,c as se,O as be,s as _e,F as Q,v as xe,a5 as ce,a6 as we}from"./vendor-d5356dcc.js";import{D as q}from"./enum-cbdb10ae.js";import{u as Me}from"./index-dd02b9c0.js";import{b as ue}from"./index-ac54fc13.js";const Se=B('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),Ce=s=>{const{title:v,content:o,onCollapse:p}=s,M=()=>{const _="collapse-open",f="collapse-close";return s.isOpen?_:f},S=()=>{const _="opacity-100",f="opacity-0";return s.isOpen?_:f};return(()=>{const _=Se(),f=_.firstChild,i=f.nextSibling;return f.$$click=()=>p(!s.isOpen),b(f,v),b(i,k(ne,{get when(){return s.isOpen},children:o})),re(a=>{const h=K(M(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),$=K(S(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return h!==a._v$&&Z(_,a._v$=h),$!==a._v$2&&Z(i,a._v$2=$),a},{_v$:void 0,_v$2:void 0}),_})()},de=Ce;ae(["click"]);const[De,Ne]=se([]),[Oe,Te]=se([]),[te,fe]=se({});function ie(){const s=Me(),v=f=>{f.forEach(i=>{var a;fe({...te(),[i.name]:{udp:i.udp,type:i.type,delay:((a=i.history.at(-1))==null?void 0:a.delay)??0,name:i.name}})})},o=async()=>{const{providers:f}=await s.get("providers/proxies").json();Object.values(f).forEach(h=>{v(h.proxies)}),Te(Object.values(f).filter(h=>h.name!=="default"&&h.vehicleType!=="Compatible"));const{proxies:i}=await s.get("proxies").json(),a=[...i.GLOBAL.all??[],"GLOBAL"];v(Object.values(i)),Ne(Object.values(i).filter(h=>{var $;return($=h.all)==null?void 0:$.length}).sort((h,$)=>a.indexOf(h.name)-a.indexOf($.name)))};return{proxies:De,proxyProviders:Oe,delayTestByProxyGroupName:async f=>{const i=await s.get(`group/${f}/delay`,{searchParams:{url:"https://www.gstatic.com/generate_204",timeout:2e3}}).json();Object.entries(i).forEach(([a,h])=>{fe({...te(),[a]:{...te()[a],delay:h}})})},proxyNodeMap:te,updateProxy:o,setProxyGroupByProxyName:async(f,i)=>{await s.put(`proxies/${f.name}`,{body:JSON.stringify({name:i})}),await o()},updateProviderByProviderName:async f=>{await s.put(`providers/proxies/${f}`),await o()},healthCheckByProviderName:async f=>{await s.get(`providers/proxies/${f}/healthcheck`,{timeout:30*1e3}),await o()}}}const ke=B("<span>ms"),Pe=B('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),he=s=>{const{proxyName:v,isSelected:o,onClick:p}=s,{proxyNodeMap:M}=ie(),S=be(()=>M()[v]),_=i=>{if(typeof i!="number"||i===q.NOT_CONNECTED)return"";let a="text-success";return i>q.HIGH?a="text-error":i>q.MEDIUM&&(a="text-warning"),(()=>{const h=ke(),$=h.firstChild;return Z(h,a),b(h,i,$),h})()},f=(i="")=>{const a=i.toLowerCase();return a.includes("shadowsocks")?a.replace("shadowsocks","ss"):a};return(()=>{const i=Pe(),a=i.firstChild,h=a.nextSibling,$=h.firstChild,A=$.nextSibling;return i.$$click=()=>p==null?void 0:p(),_e(i,"data-tip",v),b(a,v),b($,()=>{var c;return f((c=S())==null?void 0:c.type)},null),b($,()=>{var c;return((c=S())==null?void 0:c.udp)&&" :: udp"},null),b(A,()=>{var c;return _((c=S())==null?void 0:c.delay)}),re(c=>{const C=K("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 border-neutral-focus bg-neutral p-3 text-neutral-content",o&&"border-primary bg-primary-content text-primary",p&&"cursor-pointer"),D=K("truncate text-xs text-slate-500",o&&"text-primary");return C!==c._v$&&Z(i,c._v$=C),D!==c._v$2&&Z($,c._v$2=D),c},{_v$:void 0,_v$2:void 0}),i})()};ae(["click"]);const Le=B("<div>"),je=B('<div class="flex w-full flex-wrap">'),Be=s=>{let v=s.selected?"bg-white border-4 border-success":"bg-success";return typeof s.delay!="number"||s.delay===q.NOT_CONNECTED?v=s.selected?"bg-white border-4 border-neutral":"bg-neutral":s.delay>q.HIGH?v=s.selected?"bg-white border-4 border-error":"bg-error":s.delay>q.MEDIUM&&(v=s.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const o=Le();return re(()=>Z(o,K("m-1 h-4 w-4 rounded-full",v))),o})()},me=s=>{const{proxyNodeMap:v}=ie();return(()=>{const o=je();return b(o,k(Q,{get each(){return s.proxyNameList.map(p=>v()[p])},children:p=>{const M=p==null?void 0:p.delay,S=s.now===p.name;return k(Be,{delay:M,selected:S})}})),o})()};var pe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ge(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ve={exports:{}};(function(s,v){(function(o,p){s.exports=p()})(pe,function(){var o=1e3,p=6e4,M=36e5,S="millisecond",_="second",f="minute",i="hour",a="day",h="week",$="month",A="quarter",c="year",C="date",D="Invalid Date",F=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,P={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var n=["th","st","nd","rd"],e=l%100;return"["+l+(n[(e-20)%10]||n[e]||n[0])+"]"}},G=function(l,n,e){var r=String(l);return!r||r.length>=n?l:""+Array(n+1-r.length).join(e)+l},x={s:G,z:function(l){var n=-l.utcOffset(),e=Math.abs(n),r=Math.floor(e/60),t=e%60;return(n<=0?"+":"-")+G(r,2,"0")+":"+G(t,2,"0")},m:function l(n,e){if(n.date()<e.date())return-l(e,n);var r=12*(e.year()-n.year())+(e.month()-n.month()),t=n.clone().add(r,$),u=e-t<0,d=n.clone().add(r+(u?-1:1),$);return+(-(r+(e-t)/(u?t-d:d-t))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:$,y:c,w:h,d:a,D:C,h:i,m:f,s:_,ms:S,Q:A}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},m="en",w={};w[m]=P;var I=function(l){return l instanceof X},Y=function l(n,e,r){var t;if(!n)return m;if(typeof n=="string"){var u=n.toLowerCase();w[u]&&(t=u),e&&(w[u]=e,t=u);var d=n.split("-");if(!t&&d.length>1)return l(d[0])}else{var y=n.name;w[y]=n,t=y}return!r&&t&&(m=t),t||!r&&m},O=function(l,n){if(I(l))return l.clone();var e=typeof n=="object"?n:{};return e.date=l,e.args=arguments,new X(e)},g=x;g.l=Y,g.i=I,g.w=function(l,n){return O(l,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var X=function(){function l(e){this.$L=Y(e.locale,null,!0),this.parse(e)}var n=l.prototype;return n.parse=function(e){this.$d=function(r){var t=r.date,u=r.utc;if(t===null)return new Date(NaN);if(g.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var d=t.match(F);if(d){var y=d[2]-1||0,T=(d[7]||"0").substring(0,3);return u?new Date(Date.UTC(d[1],y,d[3]||1,d[4]||0,d[5]||0,d[6]||0,T)):new Date(d[1],y,d[3]||1,d[4]||0,d[5]||0,d[6]||0,T)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return g},n.isValid=function(){return this.$d.toString()!==D},n.isSame=function(e,r){var t=O(e);return this.startOf(r)<=t&&t<=this.endOf(r)},n.isAfter=function(e,r){return O(e)<this.startOf(r)},n.isBefore=function(e,r){return this.endOf(r)<O(e)},n.$g=function(e,r,t){return g.u(e)?this[r]:this.set(t,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,r){var t=this,u=!!g.u(r)||r,d=g.p(e),y=function(J,E){var U=g.w(t.$u?Date.UTC(t.$y,E,J):new Date(t.$y,E,J),t);return u?U:U.endOf(a)},T=function(J,E){return g.w(t.toDate()[J].apply(t.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(E)),t)},L=this.$W,j=this.$M,H=this.$D,z="set"+(this.$u?"UTC":"");switch(d){case c:return u?y(1,0):y(31,11);case $:return u?y(1,j):y(0,j+1);case h:var W=this.$locale().weekStart||0,R=(L<W?L+7:L)-W;return y(u?H-R:H+(6-R),j);case a:case C:return T(z+"Hours",0);case i:return T(z+"Minutes",1);case f:return T(z+"Seconds",2);case _:return T(z+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,r){var t,u=g.p(e),d="set"+(this.$u?"UTC":""),y=(t={},t[a]=d+"Date",t[C]=d+"Date",t[$]=d+"Month",t[c]=d+"FullYear",t[i]=d+"Hours",t[f]=d+"Minutes",t[_]=d+"Seconds",t[S]=d+"Milliseconds",t)[u],T=u===a?this.$D+(r-this.$W):r;if(u===$||u===c){var L=this.clone().set(C,1);L.$d[y](T),L.init(),this.$d=L.set(C,Math.min(this.$D,L.daysInMonth())).$d}else y&&this.$d[y](T);return this.init(),this},n.set=function(e,r){return this.clone().$set(e,r)},n.get=function(e){return this[g.p(e)]()},n.add=function(e,r){var t,u=this;e=Number(e);var d=g.p(r),y=function(j){var H=O(u);return g.w(H.date(H.date()+Math.round(j*e)),u)};if(d===$)return this.set($,this.$M+e);if(d===c)return this.set(c,this.$y+e);if(d===a)return y(1);if(d===h)return y(7);var T=(t={},t[f]=p,t[i]=M,t[_]=o,t)[d]||1,L=this.$d.getTime()+e*T;return g.w(L,this)},n.subtract=function(e,r){return this.add(-1*e,r)},n.format=function(e){var r=this,t=this.$locale();if(!this.isValid())return t.invalidDate||D;var u=e||"YYYY-MM-DDTHH:mm:ssZ",d=g.z(this),y=this.$H,T=this.$m,L=this.$M,j=t.weekdays,H=t.months,z=t.meridiem,W=function(E,U,V,ee){return E&&(E[U]||E(r,u))||V[U].slice(0,ee)},R=function(E){return g.s(y%12||12,E,"0")},J=z||function(E,U,V){var ee=E<12?"AM":"PM";return V?ee.toLowerCase():ee};return u.replace(N,function(E,U){return U||function(V){switch(V){case"YY":return String(r.$y).slice(-2);case"YYYY":return g.s(r.$y,4,"0");case"M":return L+1;case"MM":return g.s(L+1,2,"0");case"MMM":return W(t.monthsShort,L,H,3);case"MMMM":return W(H,L);case"D":return r.$D;case"DD":return g.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return W(t.weekdaysMin,r.$W,j,2);case"ddd":return W(t.weekdaysShort,r.$W,j,3);case"dddd":return j[r.$W];case"H":return String(y);case"HH":return g.s(y,2,"0");case"h":return R(1);case"hh":return R(2);case"a":return J(y,T,!0);case"A":return J(y,T,!1);case"m":return String(T);case"mm":return g.s(T,2,"0");case"s":return String(r.$s);case"ss":return g.s(r.$s,2,"0");case"SSS":return g.s(r.$ms,3,"0");case"Z":return d}return null}(E)||d.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,r,t){var u,d=this,y=g.p(r),T=O(e),L=(T.utcOffset()-this.utcOffset())*p,j=this-T,H=function(){return g.m(d,T)};switch(y){case c:u=H()/12;break;case $:u=H();break;case A:u=H()/3;break;case h:u=(j-L)/6048e5;break;case a:u=(j-L)/864e5;break;case i:u=j/M;break;case f:u=j/p;break;case _:u=j/o;break;default:u=j}return t?u:g.a(u)},n.daysInMonth=function(){return this.endOf($).$D},n.$locale=function(){return w[this.$L]},n.locale=function(e,r){if(!e)return this.$L;var t=this.clone(),u=Y(e,r,!0);return u&&(t.$L=u),t},n.clone=function(){return g.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},l}(),le=X.prototype;return O.prototype=le,[["$ms",S],["$s",_],["$m",f],["$H",i],["$W",a],["$M",$],["$y",c],["$D",C]].forEach(function(l){le[l[1]]=function(n){return this.$g(n,l[0],l[1])}}),O.extend=function(l,n){return l.$i||(l(n,X,O),l.$i=!0),O},O.locale=Y,O.isDayjs=I,O.unix=function(l){return O(1e3*l)},O.en=w[m],O.Ls=w,O.p={},O})})(ve);var Ee=ve.exports;const oe=ge(Ee),Ye=B('<progress class="progress" max="100">'),He=B('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Ie=B('<div class="text-sm text-slate-500">Expire: <!> '),Ae=s=>{const v=ue(s.Total),o=ue(s.Download+s.Upload),p=((s.Download+s.Upload)/s.Total*100).toFixed(2);return{total:v,used:o,percentage:p,expireStr:()=>s.Expire===0?"Null":oe(s.Expire*1e3).format("YYYY-MM-DD")}},Ge=s=>{if(!s.subscriptionInfo)return;const v=Ae(s.subscriptionInfo);return[(()=>{const o=Ye();return re(()=>o.value=v.percentage),o})(),(()=>{const o=He(),p=o.firstChild,M=p.nextSibling,S=M.nextSibling,_=S.nextSibling;return _.nextSibling,b(o,()=>`${v.used}`,p),b(o,()=>`${v.total}`,M),b(o,()=>v.percentage,_),o})(),(()=>{const o=Ie(),p=o.firstChild,M=p.nextSibling;return M.nextSibling,b(o,()=>v.expireStr(),M),o})()]};var ye={exports:{}};(function(s,v){(function(o,p){s.exports=p()})(pe,function(){return function(o,p,M){o=o||{};var S=p.prototype,_={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function f(a,h,$,A){return S.fromToBase(a,h,$,A)}M.en.relativeTime=_,S.fromToBase=function(a,h,$,A,c){for(var C,D,F,N=$.$locale().relativeTime||_,P=o.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],G=P.length,x=0;x<G;x+=1){var m=P[x];m.d&&(C=A?M(a).diff($,m.d,!0):$.diff(a,m.d,!0));var w=(o.rounding||Math.round)(Math.abs(C));if(F=C>0,w<=m.r||!m.r){w<=1&&x>0&&(m=P[x-1]);var I=N[m.l];c&&(w=c(""+w)),D=typeof I=="string"?I.replace("%d",w):I(w,h,m.l,F);break}}if(h)return D;var Y=F?N.future:N.past;return typeof Y=="function"?Y(D):Y.replace("%s",D)},S.to=function(a,h){return f(a,h,this,!0)},S.from=function(a,h){return f(a,h,this)};var i=function(a){return a.$u?M.utc():M()};S.toNow=function(a){return this.to(i(this),a)},S.fromNow=function(a){return this.from(i(this),a)}}})})(ye);var Ue=ye.exports;const Fe=ge(Ue);oe.extend(Fe);function We(s){return oe(s).fromNow()}const Je=B('<h1 class="pb-4 text-lg font-semibold">Proxy Providers'),ze=B('<div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),Ze=B('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),qe=B('<div class="mr-10 flex items-center justify-between"><span></span><button class="btn btn-circle btn-sm">'),Re=B('<div class="text-sm text-slate-500"> :: '),$e=B("<div>"),Ve=B('<div class="mr-10 flex items-center justify-between"><span></span><div><button class="btn btn-circle btn-sm mr-2"></button><button class="btn btn-circle btn-sm">'),Qe=B('<div class="text-sm text-slate-500"> :: Updated '),nt=()=>{const{proxies:s,proxyProviders:v,updateProxy:o,setProxyGroupByProxyName:p,delayTestByProxyGroupName:M,updateProviderByProviderName:S,healthCheckByProviderName:_}=ie(),[f,i]=se({});xe(async()=>{await o()});const a=async(c,C)=>{p(c,C)},h=async(c,C)=>{const D=c.target;D.classList.add("animate-pulse"),c.stopPropagation(),await M(C),D.classList.remove("animate-pulse")},$=async(c,C)=>{const D=c.target;D.classList.add("animate-pulse"),c.stopPropagation(),await _(C),D.classList.remove("animate-pulse")},A=async(c,C)=>{const D=c.target;D.classList.add("animate-spin"),c.stopPropagation(),await S(C),D.classList.remove("animate-spin")};return(()=>{const c=Ze(),C=c.firstChild,D=C.firstChild,F=D.nextSibling;return b(F,k(Q,{get each(){return s()},children:N=>{const P=[(()=>{const x=qe(),m=x.firstChild,w=m.nextSibling;return b(m,()=>N.name),w.$$click=I=>h(I,N.name),b(w,k(ce,{})),x})(),(()=>{const x=Re(),m=x.firstChild;return b(x,()=>N.type,m),b(x,()=>N.now,null),x})(),k(ne,{get when(){return!f()[`group-${N.name}`]},get children(){return k(me,{get proxyNameList(){return N.all??[]},get now(){return N.now}})}})],G=k(Q,{get each(){return N.all},children:x=>k(he,{proxyName:x,get isSelected(){return N.now===x},onClick:()=>a(N,x)})});return(()=>{const x=$e();return b(x,k(de,{get isOpen(){return f()[`group-${N.name}`]},title:P,content:G,onCollapse:m=>i({...f(),[`group-${N.name}`]:m})})),x})()}})),b(c,k(ne,{get when(){return v().length>0},get children(){return[Je(),(()=>{const N=ze();return b(N,k(Q,{get each(){return v()},children:P=>{const G=[(()=>{const m=Ve(),w=m.firstChild,I=w.nextSibling,Y=I.firstChild,O=Y.nextSibling;return b(w,()=>P.name),Y.$$click=g=>A(g,P.name),b(Y,k(we,{})),O.$$click=g=>$(g,P.name),b(O,k(ce,{})),m})(),k(Ge,{get subscriptionInfo(){return P.subscriptionInfo}}),(()=>{const m=Qe(),w=m.firstChild;return b(m,()=>P.vehicleType,w),b(m,()=>We(P.updatedAt),null),m})(),k(ne,{get when(){return!f()[`provider-${P.name}`]},get children(){return k(me,{get proxyNameList(){return P.proxies.map(m=>m.name)??[]}})}})],x=k(Q,{get each(){return P.proxies},children:m=>k(he,{get proxyName(){return m.name}})});return(()=>{const m=$e();return b(m,k(de,{get isOpen(){return f()[`provider-${P.name}`]},title:G,content:x,onCollapse:w=>i({...f(),[`provider-${P.name}`]:w})})),m})()}})),N})()]}}),null),c})()};ae(["click"]);export{nt as default};
