import{i as c,r as k,T as _,d as B,t as f,c as v,J as T,s as L,p as q,b as x,X as D,F as C}from"./vendor-e7ea9428.js";import{t as w}from"./tw-merge-1166cefb.js";import{u as I}from"./index-64b660e1.js";const J=f('<div><div class="collapse-title text-xl font-medium"></div><div>'),R=i=>{const{title:p,content:$,onCollapse:g}=i,d=()=>{const s="collapse-open",l="collapse-close";return i.isOpen?s:l},a=()=>{const s="opacity-100",l="opacity-0 scale-y-0";return i.isOpen?s:l};return(()=>{const s=J(),l=s.firstChild,o=l.nextSibling;return l.$$click=()=>g(!i.isOpen),c(l,p),c(o,$),k(e=>{const t=w(d(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),u=w(a(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return t!==e._v$&&_(s,e._v$=t),u!==e._v$2&&_(o,e._v$2=u),e},{_v$:void 0,_v$2:void 0}),s})()},S=R;B(["click"]);const[X,z]=v([]),[H,K]=v([]),[N,O]=v({}),[M,Q]=v({});function E(){const i=I(),p=async()=>{const{providers:d}=await i.get("providers/proxies").json(),a=N();Object.values(d).forEach(o=>{o.proxies.forEach(e=>{var t;Q({...M(),[e.name]:e}),a[e.name]=(t=e.history[e.history.length-1])==null?void 0:t.delay})}),O(a),K(Object.values(d).filter(o=>o.name!=="default"&&o.vehicleType!=="Compatible"));const{proxies:s}=await i.get("proxies").json(),l=s.GLOBAL.all??[];z(Object.values(s).filter(o=>o.all&&o.all.length>0).sort((o,e)=>l.indexOf(o.name)-l.indexOf(e.name)))};return{proxies:X,proxyProviders:H,delayTestByProxyGroupName:async d=>{const a=await i.get(`group/${d}/delay?url=https%3A%2F%2Fwww.gstatic.com%2Fgenerate_204&timeout=2000`).json(),s=N();Object.entries(a).forEach(([l,o])=>{s[l]=o}),O({...s})},proxyNodeMap:M,delayMap:N,updateProxy:p,setProxiesByProxyName:async(d,a)=>{await i.put(`proxies/${d.name}`,{body:JSON.stringify({name:a})}),await p()}}}const U=f("<span>ms"),V=f('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div class="truncate text-xs text-slate-500"></div><div class="text-xs">'),j=i=>{const{proxyName:p,isSelected:$,onClick:g}=i,{delayMap:d,proxyNodeMap:a}=E(),s=T(()=>a()[p]),l=e=>{const t=d()[e];if(typeof t!="number"||t===0)return"";let u="text-green-500";return t>500?u="text-red-500":t>200&&(u="text-yellow-500"),(()=>{const m=U(),y=m.firstChild;return _(m,u),c(m,t,y),m})()},o=e=>{const t=e.toLowerCase();return t==="shadowsocks"?"SS":t};return(()=>{const e=V(),t=e.firstChild,u=t.nextSibling,m=u.firstChild,y=m.nextSibling;return e.$$click=()=>g==null?void 0:g(),L(e,"data-tip",p),c(t,p),c(m,()=>o(s().type),null),c(m,()=>s().udp?" :: udp":"",null),c(y,()=>l(p)),k(()=>_(e,w("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 p-4",$?"border-primary bg-success-content text-success":"border-secondary",g&&"cursor-pointer"))),e})()};B(["click"]);const W=f('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2"></div></div><div><h1 class="pb-4 text-lg font-semibold">Proxy Providers</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),Y=f('<div class="flex items-center gap-2"><span>'),Z=f('<div class="text-sm text-slate-500"> :: '),oe=()=>{const{proxies:i,proxyProviders:p,updateProxy:$,setProxiesByProxyName:g,delayTestByProxyGroupName:d}=E(),[a,s]=v({});q(async()=>{await $()});const l=async(e,t)=>{g(e,t)},o=(e,t)=>{e.stopPropagation(),d(t)};return(()=>{const e=W(),t=e.firstChild,u=t.firstChild,m=u.nextSibling,y=t.nextSibling,F=y.firstChild,G=F.nextSibling;return c(m,x(C,{get each(){return i()},children:r=>{const h=[(()=>{const n=Y(),P=n.firstChild;return c(P,()=>r.name),c(n,x(D,{class:"cursor-pointer",onClick:A=>o(A,r.name)}),null),n})(),(()=>{const n=Z(),P=n.firstChild;return c(n,()=>r.type,P),c(n,()=>r.now,null),n})()],b=x(C,{get each(){return r.all},children:n=>x(j,{proxyName:n,get isSelected(){return r.now===n},onClick:()=>l(r,n)})});return x(S,{get isOpen(){return a()[`group-${r.name}`]},title:h,content:b,onCollapse:n=>s({...a(),[`group-${r.name}`]:n})})}})),c(G,x(C,{get each(){return p()},children:r=>{const h=T(()=>r.name),b=x(C,{get each(){return r.proxies},children:n=>x(j,{get proxyName(){return n.name}})});return x(S,{get isOpen(){return a()[`provider-${r.name}`]},title:h,content:b,onCollapse:n=>s({...a(),[`provider-${r.name}`]:n})})}})),e})()};export{oe as default};
