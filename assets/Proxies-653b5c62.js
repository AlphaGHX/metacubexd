import{i as M,b as D,S as K,f as se,t as ee,g as R,d as ie,h as L,c as q,O as X,s as we,F as _e,v as Me,a5 as ce,a6 as Ce}from"./vendor-9ef7e570.js";import{I as Se}from"./index-ae7b006c.js";import{D as Z}from"./enum-cbdb10ae.js";import{u as De}from"./index-c727de2c.js";import{b as ue}from"./index-ac54fc13.js";const Ne=L('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),Oe=r=>{const{title:p,content:a,onCollapse:m}=r,v=()=>{const x="collapse-open",h="collapse-close";return r.isOpen?x:h},y=()=>{const x="opacity-100",h="opacity-0";return r.isOpen?x:h};return(()=>{const x=Ne(),h=x.firstChild,l=h.nextSibling;return h.$$click=()=>m(!r.isOpen),M(h,p),M(l,D(K,{get when(){return r.isOpen},children:a})),se(i=>{const $=ee(v(),"collapse collapse-arrow mb-2 overflow-visible border-secondary bg-base-200"),g=ee(y(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return $!==i._v$&&R(x,i._v$=$),g!==i._v$2&&R(l,i._v$2=g),i},{_v$:void 0,_v$2:void 0}),x})()},de=Oe;ie(["click"]);const Te=L('<div class="ml-2 flex flex-1 flex-col">'),ke=L('<div class="flex"><div class="flex flex-1 flex-col">'),[Pe,ge]=q(0);var pe;ge((pe=document==null?void 0:document.body)==null?void 0:pe.clientWidth);window.addEventListener("resize",()=>{ge(document.body.clientWidth)});const Le=r=>{const p=X(()=>Pe()>=640),a=X(()=>r.subChild.filter((v,y)=>y%2===0||!p())),m=X(()=>r.subChild.filter((v,y)=>y%2===1));return(()=>{const v=ke(),y=v.firstChild;return M(y,a),M(v,D(K,{get when(){return p()},get children(){const x=Te();return M(x,m),x}}),null),v})()},fe=Le,[je,Ee]=q([]),[Be,Ye]=q([]),[re,he]=q({});function ae(){const r=De(),p=h=>{h.forEach(l=>{var i;he({...re(),[l.name]:{udp:l.udp,type:l.type,delay:((i=l.history.at(-1))==null?void 0:i.delay)??0,name:l.name}})})},a=async()=>{const{providers:h}=await r.get("providers/proxies").json();Object.values(h).forEach($=>{p($.proxies)}),Ye(Object.values(h).filter($=>$.name!=="default"&&$.vehicleType!=="Compatible"));const{proxies:l}=await r.get("proxies").json(),i=[...l.GLOBAL.all??[],"GLOBAL"];p(Object.values(l)),Ee(Object.values(l).filter($=>{var g;return(g=$.all)==null?void 0:g.length}).sort(($,g)=>i.indexOf($.name)-i.indexOf(g.name)))};return{proxies:je,proxyProviders:Be,delayTestByProxyGroupName:async h=>{const l=await r.get(`group/${h}/delay`,{searchParams:{url:"https://www.gstatic.com/generate_204",timeout:2e3}}).json();Object.entries(l).forEach(([i,$])=>{he({...re(),[i]:{...re()[i],delay:$}})})},proxyNodeMap:re,updateProxy:a,setProxyGroupByProxyName:async(h,l)=>{await r.put(`proxies/${h.name}`,{body:JSON.stringify({name:l})}),await a()},updateProviderByProviderName:async h=>{await r.put(`providers/proxies/${h}`),await a()},healthCheckByProviderName:async h=>{await r.get(`providers/proxies/${h}/healthcheck`,{timeout:30*1e3}),await a()}}}const He=L("<span>ms"),Ie=L('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),We=r=>{const{proxyName:p,isSelected:a,onClick:m}=r,{proxyNodeMap:v}=ae(),y=X(()=>v()[p]),x=l=>{if(typeof l!="number"||l===Z.NOT_CONNECTED)return"";let i="text-success";return l>Z.HIGH?i="text-error":l>Z.MEDIUM&&(i="text-warning"),(()=>{const $=He(),g=$.firstChild;return R($,i),M($,l,g),$})()},h=(l="")=>{const i=l.toLowerCase();return i.includes("shadowsocks")?i.replace("shadowsocks","ss"):i};return(()=>{const l=Ie(),i=l.firstChild,$=i.nextSibling,g=$.firstChild,I=g.nextSibling;return l.$$click=()=>m==null?void 0:m(),we(l,"data-tip",p),M(i,p),M(g,()=>{var u;return h((u=y())==null?void 0:u.type)},null),M(g,()=>{var u;return((u=y())==null?void 0:u.udp)&&" :: udp"},null),M(I,()=>{var u;return x((u=y())==null?void 0:u.delay)}),se(u=>{const C=ee("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 border-neutral-focus bg-neutral p-3 text-neutral-content",a&&"border-primary bg-primary-content text-primary",m&&"cursor-pointer"),o=ee("truncate text-xs text-slate-500",a&&"text-primary");return C!==u._v$&&R(l,u._v$=C),o!==u._v$2&&R(g,u._v$2=o),u},{_v$:void 0,_v$2:void 0}),l})()};ie(["click"]);const me=r=>{const[p,a]=q(30),m=X(()=>r.proxies.slice(0,p()));return D(Se,{get each(){return m()},get hasMore(){return m().length<r.proxies.length},next:()=>a(p()+30),children:v=>D(We,{proxyName:v,get isSelected(){return r.now===v},onClick:()=>{var y;(y=r.onClick)==null||y.call(r,v)}})})},Ae=L("<div>"),Ge=L('<div class="flex w-full flex-wrap">'),Fe=r=>{let p=r.selected?"bg-white border-4 border-success":"bg-success";return typeof r.delay!="number"||r.delay===Z.NOT_CONNECTED?p=r.selected?"bg-white border-4 border-neutral":"bg-neutral":r.delay>Z.HIGH?p=r.selected?"bg-white border-4 border-error":"bg-error":r.delay>Z.MEDIUM&&(p=r.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const a=Ae();return se(()=>R(a,ee("m-1 h-4 w-4 rounded-full",p))),a})()},$e=r=>{const{proxyNodeMap:p}=ae();return(()=>{const a=Ge();return M(a,D(_e,{get each(){return r.proxyNameList.map(m=>p()[m])},children:m=>{const v=m==null?void 0:m.delay,y=r.now===m.name;return D(Fe,{delay:v,selected:y})}})),a})()};var ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ye(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var be={exports:{}};(function(r,p){(function(a,m){r.exports=m()})(ve,function(){var a=1e3,m=6e4,v=36e5,y="millisecond",x="second",h="minute",l="hour",i="day",$="week",g="month",I="quarter",u="year",C="date",o="Invalid Date",W=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(c){var n=["th","st","nd","rd"],e=c%100;return"["+c+(n[(e-20)%10]||n[e]||n[0])+"]"}},j=function(c,n,e){var s=String(c);return!s||s.length>=n?c:""+Array(n+1-s.length).join(e)+c},B={s:j,z:function(c){var n=-c.utcOffset(),e=Math.abs(n),s=Math.floor(e/60),t=e%60;return(n<=0?"+":"-")+j(s,2,"0")+":"+j(t,2,"0")},m:function c(n,e){if(n.date()<e.date())return-c(e,n);var s=12*(e.year()-n.year())+(e.month()-n.month()),t=n.clone().add(s,g),d=e-t<0,f=n.clone().add(s+(d?-1:1),g);return+(-(s+(e-t)/(d?t-f:f-t))||0)},a:function(c){return c<0?Math.ceil(c)||0:Math.floor(c)},p:function(c){return{M:g,y:u,w:$,d:i,D:C,h:l,m:h,s:x,ms:y,Q:I}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(c){return c===void 0}},N="en",k={};k[N]=b;var H=function(c){return c instanceof te},G=function c(n,e,s){var t;if(!n)return N;if(typeof n=="string"){var d=n.toLowerCase();k[d]&&(t=d),e&&(k[d]=e,t=d);var f=n.split("-");if(!t&&f.length>1)return c(f[0])}else{var _=n.name;k[_]=n,t=_}return!s&&t&&(N=t),t||!s&&N},O=function(c,n){if(H(c))return c.clone();var e=typeof n=="object"?n:{};return e.date=c,e.args=arguments,new te(e)},w=B;w.l=G,w.i=H,w.w=function(c,n){return O(c,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var te=function(){function c(e){this.$L=G(e.locale,null,!0),this.parse(e)}var n=c.prototype;return n.parse=function(e){this.$d=function(s){var t=s.date,d=s.utc;if(t===null)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var f=t.match(W);if(f){var _=f[2]-1||0,S=(f[7]||"0").substring(0,3);return d?new Date(Date.UTC(f[1],_,f[3]||1,f[4]||0,f[5]||0,f[6]||0,S)):new Date(f[1],_,f[3]||1,f[4]||0,f[5]||0,f[6]||0,S)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return w},n.isValid=function(){return this.$d.toString()!==o},n.isSame=function(e,s){var t=O(e);return this.startOf(s)<=t&&t<=this.endOf(s)},n.isAfter=function(e,s){return O(e)<this.startOf(s)},n.isBefore=function(e,s){return this.endOf(s)<O(e)},n.$g=function(e,s,t){return w.u(e)?this[s]:this.set(t,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,s){var t=this,d=!!w.u(s)||s,f=w.p(e),_=function(z,E){var F=w.w(t.$u?Date.UTC(t.$y,E,z):new Date(t.$y,E,z),t);return d?F:F.endOf(i)},S=function(z,E){return w.w(t.toDate()[z].apply(t.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(E)),t)},T=this.$W,P=this.$M,Y=this.$D,J="set"+(this.$u?"UTC":"");switch(f){case u:return d?_(1,0):_(31,11);case g:return d?_(1,P):_(0,P+1);case $:var U=this.$locale().weekStart||0,V=(T<U?T+7:T)-U;return _(d?Y-V:Y+(6-V),P);case i:case C:return S(J+"Hours",0);case l:return S(J+"Minutes",1);case h:return S(J+"Seconds",2);case x:return S(J+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,s){var t,d=w.p(e),f="set"+(this.$u?"UTC":""),_=(t={},t[i]=f+"Date",t[C]=f+"Date",t[g]=f+"Month",t[u]=f+"FullYear",t[l]=f+"Hours",t[h]=f+"Minutes",t[x]=f+"Seconds",t[y]=f+"Milliseconds",t)[d],S=d===i?this.$D+(s-this.$W):s;if(d===g||d===u){var T=this.clone().set(C,1);T.$d[_](S),T.init(),this.$d=T.set(C,Math.min(this.$D,T.daysInMonth())).$d}else _&&this.$d[_](S);return this.init(),this},n.set=function(e,s){return this.clone().$set(e,s)},n.get=function(e){return this[w.p(e)]()},n.add=function(e,s){var t,d=this;e=Number(e);var f=w.p(s),_=function(P){var Y=O(d);return w.w(Y.date(Y.date()+Math.round(P*e)),d)};if(f===g)return this.set(g,this.$M+e);if(f===u)return this.set(u,this.$y+e);if(f===i)return _(1);if(f===$)return _(7);var S=(t={},t[h]=m,t[l]=v,t[x]=a,t)[f]||1,T=this.$d.getTime()+e*S;return w.w(T,this)},n.subtract=function(e,s){return this.add(-1*e,s)},n.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||o;var d=e||"YYYY-MM-DDTHH:mm:ssZ",f=w.z(this),_=this.$H,S=this.$m,T=this.$M,P=t.weekdays,Y=t.months,J=t.meridiem,U=function(E,F,Q,ne){return E&&(E[F]||E(s,d))||Q[F].slice(0,ne)},V=function(E){return w.s(_%12||12,E,"0")},z=J||function(E,F,Q){var ne=E<12?"AM":"PM";return Q?ne.toLowerCase():ne};return d.replace(A,function(E,F){return F||function(Q){switch(Q){case"YY":return String(s.$y).slice(-2);case"YYYY":return w.s(s.$y,4,"0");case"M":return T+1;case"MM":return w.s(T+1,2,"0");case"MMM":return U(t.monthsShort,T,Y,3);case"MMMM":return U(Y,T);case"D":return s.$D;case"DD":return w.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return U(t.weekdaysMin,s.$W,P,2);case"ddd":return U(t.weekdaysShort,s.$W,P,3);case"dddd":return P[s.$W];case"H":return String(_);case"HH":return w.s(_,2,"0");case"h":return V(1);case"hh":return V(2);case"a":return z(_,S,!0);case"A":return z(_,S,!1);case"m":return String(S);case"mm":return w.s(S,2,"0");case"s":return String(s.$s);case"ss":return w.s(s.$s,2,"0");case"SSS":return w.s(s.$ms,3,"0");case"Z":return f}return null}(E)||f.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,s,t){var d,f=this,_=w.p(s),S=O(e),T=(S.utcOffset()-this.utcOffset())*m,P=this-S,Y=function(){return w.m(f,S)};switch(_){case u:d=Y()/12;break;case g:d=Y();break;case I:d=Y()/3;break;case $:d=(P-T)/6048e5;break;case i:d=(P-T)/864e5;break;case l:d=P/v;break;case h:d=P/m;break;case x:d=P/a;break;default:d=P}return t?d:w.a(d)},n.daysInMonth=function(){return this.endOf(g).$D},n.$locale=function(){return k[this.$L]},n.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),d=G(e,s,!0);return d&&(t.$L=d),t},n.clone=function(){return w.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},c}(),le=te.prototype;return O.prototype=le,[["$ms",y],["$s",x],["$m",h],["$H",l],["$W",i],["$M",g],["$y",u],["$D",C]].forEach(function(c){le[c[1]]=function(n){return this.$g(n,c[0],c[1])}}),O.extend=function(c,n){return c.$i||(c(n,te,O),c.$i=!0),O},O.locale=G,O.isDayjs=H,O.unix=function(c){return O(1e3*c)},O.en=k[N],O.Ls=k,O.p={},O})})(be);var Ue=be.exports;const oe=ye(Ue),ze=L('<progress class="progress" max="100">'),Je=L('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Re=L('<div class="text-sm text-slate-500">Expire: <!> '),Ze=r=>{const p=ue(r.Total),a=ue(r.Download+r.Upload),m=((r.Download+r.Upload)/r.Total*100).toFixed(2);return{total:p,used:a,percentage:m,expireStr:()=>r.Expire===0?"Null":oe(r.Expire*1e3).format("YYYY-MM-DD")}},qe=r=>{if(!r.subscriptionInfo)return;const p=Ze(r.subscriptionInfo);return[(()=>{const a=ze();return se(()=>a.value=p.percentage),a})(),(()=>{const a=Je(),m=a.firstChild,v=m.nextSibling,y=v.nextSibling,x=y.nextSibling;return x.nextSibling,M(a,()=>`${p.used}`,m),M(a,()=>`${p.total}`,v),M(a,()=>p.percentage,x),a})(),(()=>{const a=Re(),m=a.firstChild,v=m.nextSibling;return v.nextSibling,M(a,()=>p.expireStr(),v),a})()]};var xe={exports:{}};(function(r,p){(function(a,m){r.exports=m()})(ve,function(){return function(a,m,v){a=a||{};var y=m.prototype,x={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function h(i,$,g,I){return y.fromToBase(i,$,g,I)}v.en.relativeTime=x,y.fromToBase=function(i,$,g,I,u){for(var C,o,W,A=g.$locale().relativeTime||x,b=a.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],j=b.length,B=0;B<j;B+=1){var N=b[B];N.d&&(C=I?v(i).diff(g,N.d,!0):g.diff(i,N.d,!0));var k=(a.rounding||Math.round)(Math.abs(C));if(W=C>0,k<=N.r||!N.r){k<=1&&B>0&&(N=b[B-1]);var H=A[N.l];u&&(k=u(""+k)),o=typeof H=="string"?H.replace("%d",k):H(k,$,N.l,W);break}}if($)return o;var G=W?A.future:A.past;return typeof G=="function"?G(o):G.replace("%s",o)},y.to=function(i,$){return h(i,$,this,!0)},y.from=function(i,$){return h(i,$,this)};var l=function(i){return i.$u?v.utc():v()};y.toNow=function(i){return this.to(l(this),i)},y.fromNow=function(i){return this.from(l(this),i)}}})})(xe);var Ve=xe.exports;const Qe=ye(Ve);oe.extend(Qe);function Ke(r){return oe(r).fromNow()}const Xe=L('<h1 class="pb-4 text-lg font-semibold">Proxy Providers'),et=L('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies'),tt=L('<div class="mr-10 flex items-center justify-between"><span></span><button class="btn btn-circle btn-sm">'),nt=L('<div class="text-sm text-slate-500"> :: '),rt=L('<div class="mr-10 flex items-center justify-between"><span></span><div><button class="btn btn-circle btn-sm mr-2"></button><button class="btn btn-circle btn-sm">'),st=L('<div class="text-sm text-slate-500"> :: Updated '),ut=()=>{const{proxies:r,proxyProviders:p,updateProxy:a,setProxyGroupByProxyName:m,delayTestByProxyGroupName:v,updateProviderByProviderName:y,healthCheckByProviderName:x}=ae(),[h,l]=q({});Me(async()=>{await a()});const i=async(u,C)=>{m(u,C)},$=async(u,C)=>{const o=u.target;o.classList.add("animate-pulse"),u.stopPropagation(),await v(C),o.classList.remove("animate-pulse")},g=async(u,C)=>{const o=u.target;o.classList.add("animate-pulse"),u.stopPropagation(),await x(C),o.classList.remove("animate-pulse")},I=async(u,C)=>{const o=u.target;o.classList.add("animate-spin"),u.stopPropagation(),await y(C),o.classList.remove("animate-spin")};return(()=>{const u=et(),C=u.firstChild;return C.firstChild,M(C,D(fe,{get subChild(){return r().map(o=>{const W=[(()=>{const b=tt(),j=b.firstChild,B=j.nextSibling;return M(j,()=>o.name),B.$$click=N=>$(N,o.name),M(B,D(ce,{})),b})(),(()=>{const b=nt(),j=b.firstChild;return M(b,()=>o.type,j),M(b,()=>o.now,null),b})(),D(K,{get when(){return!h()[`group-${o.name}`]},get children(){return D($e,{get proxyNameList(){return o.all??[]},get now(){return o.now}})}})],A=D(me,{get proxies(){return o.all},get now(){return o.now},onClick:b=>{i(o,b)}});return D(de,{get isOpen(){return h()[`group-${o.name}`]},title:W,content:A,onCollapse:b=>l({...h(),[`group-${o.name}`]:b})})})}}),null),M(u,D(K,{get when(){return p().length>0},get children(){return[Xe(),D(fe,{get subChild(){return p().map(o=>{const W=[(()=>{const b=rt(),j=b.firstChild,B=j.nextSibling,N=B.firstChild,k=N.nextSibling;return M(j,()=>o.name),N.$$click=H=>I(H,o.name),M(N,D(Ce,{})),k.$$click=H=>g(H,o.name),M(k,D(ce,{})),b})(),D(qe,{get subscriptionInfo(){return o.subscriptionInfo}}),(()=>{const b=st(),j=b.firstChild;return M(b,()=>o.vehicleType,j),M(b,()=>Ke(o.updatedAt),null),b})(),D(K,{get when(){return!h()[`provider-${o.name}`]},get children(){return D($e,{get proxyNameList(){return o.proxies.map(b=>b.name)??[]}})}})],A=D(me,{get proxies(){return o.proxies.map(b=>b.name)}});return D(de,{get isOpen(){return h()[`provider-${o.name}`]},title:W,content:A,onCollapse:b=>l({...h(),[`provider-${o.name}`]:b})})})}})]}}),null),u})()};ie(["click"]);export{ut as default};
