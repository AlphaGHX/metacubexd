import{p as ne,c as y,i as a,h as n,Z as me,_ as be,$ as pe,F as w,a0 as $e,S as he,a1 as ve,o as i,a2 as _e,a3 as Ce,Q as fe,j as F,m as X,e as v,a4 as J,C as W,b as N,n as O,t as P,a5 as Se,a6 as xe,B as ye,a7 as j,a8 as ee,a9 as te,aa as Ie,ab as we,s as Fe,g as De}from"./vendor-889caed6.js";import{c as Oe,g as Pe,a as Te,b as Ee,d as Re,e as Ke,f as L}from"./index-df111a0b.js";import{B as A}from"./Button-2277aac3.js";import{c as se,d as oe,f as Ge,g as ke,h as l,i as Me,t as Ne,j as Le}from"./index-4f39763d.js";const Ae=i('<div class="sortable"><div class="m-1 flex cursor-grab justify-between p-1"><span class="select-none"></span><input type="checkbox" class="toggle">'),Ve=i('<input type="checkbox" id="connection-modal" class="modal-toggle">'),ze=i('<div class="column self-stretch">'),Be=i('<div class="sortable">'),He=i('<div class="modal"><div class="modal-box w-80"></div><label class="modal-backdrop" for="connection-modal">'),je=t=>{const[I]=ne(),[E,R]=y(null),K=({draggable:c})=>R(c.id),V=({draggable:c,droppable:p})=>{if(c&&p){const d=t.order,g=d.indexOf(c.id),S=d.indexOf(p.id);if(g!==S){const _=d.slice();_.splice(S,0,..._.splice(g,1)),t.onOrderChange(_)}}},G=({key:c})=>{const p=_e(c),[d]=Ce();return(()=>{const g=Ae(),S=g.firstChild,_=S.firstChild,D=_.nextSibling;return fe(p,g,()=>!0),a(_,()=>I(c)),D.addEventListener("change",$=>{t.onVisibleChange({...t.visible,[c]:$.target.checked})}),F($=>{const k=!!p.isActiveDraggable,M=!!d.active.draggable;return k!==$._v$&&g.classList.toggle("opacity-25",$._v$=k),M!==$._v$2&&g.classList.toggle("transition-transform",$._v$2=M),$},{_v$:void 0,_v$2:void 0}),F(()=>D.checked=t.visible[c]),g})()};return[Ve(),(()=>{const c=He(),p=c.firstChild;return a(p,n(ve,{onDragStart:K,onDragEnd:V,collisionDetector:me,get children(){return[n(be,{}),(()=>{const d=ze();return a(d,n(pe,{get ids(){return t.order},get children(){return n(w,{get each(){return t.order},children:g=>n(G,{key:g})})}})),d})(),n($e,{get children(){return n(he,{get when(){return E()},get children(){const d=Be();return a(d,()=>I(E())),d}})}})]}}),null),a(p,n(A,{class:"btn-neutral btn-sm ml-auto mt-4 block",onClick:()=>{t.onOrderChange(se),t.onVisibleChange(oe)},get children(){return I("reset")}}),null),c})()]};var Ue=async t=>{typeof t=="string"?await navigator.clipboard.writeText(t):await navigator.clipboard.write(t)};const Ze=i('<div class="flex h-4 items-center">'),qe=i('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class="flex w-full items-center gap-2 md:flex-1"><input class="input input-primary input-sm flex-1 sm:input-md"><label for="connection-modal" class="btn btn-circle btn-sm sm:btn-md"></label></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),Ye=i('<button><span></span><div class="badge badge-sm">'),Qe=i("<tr>"),Xe=i('<th class="bg-base-200"><div><div>'),Je=i('<button class="cursor-pointer">'),We=i('<tr class="h-8 hover:!bg-primary hover:text-primary-content">'),et=i("<td>"),tt=i("<button><div></div><div></div><div>(<!>)");var T=function(t){return t.activeConnections="activeConnections",t.closedConnections="closedConnections",t}(T||{});const rt=()=>{const[t]=ne(),I=Ge(),[E,R]=y(""),[K,V]=y(T.activeConnections),{activeConnections:G,closedConnections:c,paused:p,setPaused:d}=ke(),g=e=>I.delete(`connections/${e}`),[S,_]=X(y(oe),{name:"columnVisibility",storage:localStorage}),[D,$]=X(y(se),{name:"columnOrder",storage:localStorage}),k=v(()=>[{header:()=>t("close"),enableGrouping:!1,enableSorting:!1,accessorKey:l.Close,cell:({row:e})=>(()=>{const r=Ze();return a(r,n(A,{class:"btn-circle btn-xs",onClick:()=>g(e.original.id),get children(){return n(J,{size:"16"})}})),r})()},{header:()=>t("ID"),enableGrouping:!1,accessorKey:l.ID,accessorFn:e=>e.id},{header:()=>t("type"),accessorKey:l.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>t("process"),accessorKey:l.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>t("host"),accessorKey:l.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>t("rules"),accessorKey:l.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>t("chains"),accessorKey:l.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>t("connectTime"),enableGrouping:!1,accessorKey:l.ConnectTime,accessorFn:e=>Me(e.start),sortingFn:(e,r)=>W(e.original.start).valueOf()-W(r.original.start).valueOf()},{header:()=>t("dlSpeed"),enableGrouping:!1,accessorKey:l.DlSpeed,accessorFn:e=>`${N(e.downloadSpeed)}/s`,sortingFn:(e,r)=>e.original.downloadSpeed-r.original.downloadSpeed},{header:()=>t("ulSpeed"),enableGrouping:!1,accessorKey:l.ULSpeed,accessorFn:e=>`${N(e.uploadSpeed)}/s`,sortingFn:(e,r)=>e.original.uploadSpeed-r.original.uploadSpeed},{header:()=>t("dl"),enableGrouping:!1,accessorKey:l.Download,accessorFn:e=>N(e.download),sortingFn:(e,r)=>e.original.download-r.original.download},{header:()=>t("ul"),enableGrouping:!1,accessorKey:l.Upload,accessorFn:e=>N(e.upload),sortingFn:(e,r)=>e.original.upload-r.original.upload},{header:()=>t("sourceIP"),accessorKey:l.SourceIP,accessorFn:e=>e.metadata.sourceIP},{header:()=>t("sourcePort"),accessorKey:l.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>t("destination"),accessorKey:l.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host}]),[M,ae]=y([]),[re,le]=y([{id:l.ConnectTime,desc:!0}]),U=Oe({state:{get columnOrder(){return D()},get grouping(){return M()},get sorting(){return re()},get columnVisibility(){return S()},get globalFilter(){return E()}},get data(){return K()===T.activeConnections?G():c()},sortDescFirst:!0,enableHiding:!0,columns:k(),onGlobalFilterChange:R,onGroupingChange:ae,onSortingChange:le,getFilteredRowModel:Pe(),getSortedRowModel:Te(),getExpandedRowModel:Ee(),getGroupedRowModel:Re(),getCoreRowModel:Ke()}),ce=v(()=>[{type:T.activeConnections,name:t("activeConnections"),count:G().length},{type:T.closedConnections,name:t("closedConnections"),count:c().length}]);return(()=>{const e=qe(),r=e.firstChild,Z=r.firstChild,z=Z.nextSibling,B=z.firstChild,H=B.nextSibling,ie=r.nextSibling,q=ie.firstChild,Y=q.firstChild,de=Y.nextSibling;return a(Z,n(w,{get each(){return ce()},children:o=>(()=>{const u=Ye(),s=u.firstChild,C=s.nextSibling;return u.$$click=()=>V(o.type),a(s,()=>o.name),a(C,()=>o.count),F(()=>O(u,P(K()===o.type&&"tab-active","tab tab-sm gap-2 sm:tab-md"))),u})()})),B.$$input=o=>R(o.target.value),a(z,n(A,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>d(o=>!o),get children(){return v(()=>!!p())()?n(Se,{}):n(xe,{})}}),H),a(z,n(A,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>I.delete("connections"),get children(){return n(J,{})}}),H),a(H,n(ye,{})),a(r,n(je,{get order(){return D()},get visible(){return S()},onOrderChange:o=>{$([...o])},onVisibleChange:o=>_({...o})}),null),a(Y,n(w,{get each(){return U.getHeaderGroups()},children:o=>(()=>{const u=Qe();return a(u,n(w,{get each(){return o.headers},children:s=>(()=>{const C=Xe(),f=C.firstChild,b=f.firstChild;return a(f,(()=>{const m=v(()=>!!s.column.getCanGroup());return()=>m()?(()=>{const h=Je();return j(h,"click",s.column.getToggleGroupingHandler(),!0),a(h,(()=>{const x=v(()=>!!s.column.getIsGrouped());return()=>x()?n(ee,{size:18}):n(te,{size:18})})()),h})():null})(),b),j(b,"click",s.column.getToggleSortingHandler(),!0),a(b,()=>L(s.column.columnDef.header,s.getContext())),a(f,()=>({asc:n(Ie,{}),desc:n(we,{})})[s.column.getIsSorted()]??null,null),F(m=>{const h=P("flex items-center gap-2"),x=P(s.column.getCanSort()&&"cursor-pointer select-none","flex-1");return h!==m._v$3&&O(f,m._v$3=h),x!==m._v$4&&O(b,m._v$4=x),m},{_v$3:void 0,_v$4:void 0}),C})()})),u})()})),a(de,n(w,{get each(){return U.getRowModel().rows},children:o=>(()=>{const u=We();return a(u,n(w,{get each(){return o.getVisibleCells()},children:s=>(()=>{const C=et();return C.$$contextmenu=f=>{f.preventDefault(),typeof s.renderValue()=="string"&&Ue(s.renderValue())},a(C,(()=>{const f=v(()=>!!s.getIsGrouped());return()=>f()?(()=>{const b=tt(),m=b.firstChild,h=m.nextSibling,x=h.nextSibling,ue=x.firstChild,Q=ue.nextSibling;return Q.nextSibling,j(b,"click",o.getToggleExpandedHandler(),!0),a(m,(()=>{const ge=v(()=>!!o.getIsExpanded());return()=>ge()?n(ee,{size:18}):n(te,{size:18})})()),a(h,()=>L(s.column.columnDef.cell,s.getContext())),a(x,()=>o.subRows.length,Q),F(()=>O(b,P(o.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),b})():(()=>{const b=v(()=>!!s.getIsAggregated());return()=>b()?L(s.column.columnDef.aggregatedCell??s.column.columnDef.cell,s.getContext()):(()=>{const m=v(()=>!!s.getIsPlaceholder());return()=>m()?null:L(s.column.columnDef.cell,s.getContext())})()})()})()),C})()})),u})()})),F(o=>{const u=t("search"),s=P(Ne(Le()),"table table-zebra relative rounded-none");return u!==o._v$&&Fe(B,"placeholder",o._v$=u),s!==o._v$2&&O(q,o._v$2=s),o},{_v$:void 0,_v$2:void 0}),e})()};De(["input","click","contextmenu"]);export{rt as default};
