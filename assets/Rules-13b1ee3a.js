import{c as $,p as q,e as E,E as O,i as e,h as r,S as A,af as W,ag as B,t as C,F as D,j as G,n as H,o as m}from"./vendor-889caed6.js";import{B as I}from"./Button-2277aac3.js";import{f as J,i as K,w as L}from"./index-eb14119a.js";import{u as Q}from"./global-c2391608.js";const V=()=>{const l=J(),[g,b]=$([]),[f,_]=$([]),o=async()=>{const[{rules:a},{providers:h}]=await Promise.all([l.get("rules").json(),l.get("providers/rules").json()]);b(Object.values(a)),_(Object.values(h))};return{rules:g,rulesProviders:f,updateRules:o,updateAllRuleProvider:async()=>{await Promise.all(f().map(a=>l.put(`providers/rules/${a.name}`))),await o()},updateRuleProviderByName:async a=>{await l.put(`providers/rules/${a}`),await o()}}},X=m('<div class="flex-1"><h1 class="flex h-11 items-center gap-2 pb-4 text-lg font-semibold">'),Y=m('<div><div class="flex-1"><h1 class="pb-4 text-lg font-semibold">'),Z=m('<div class="badge badge-sm">'),ee=m('<div class="card card-bordered card-compact mb-2 bg-base-200 p-4"><div class="flex items-center gap-2"><span class="break-all"></span></div><div class="text-xs text-slate-500"> :: '),te=m('<div class="card card-bordered card-compact mb-2 bg-base-200 p-4"><div class="flex items-center gap-2 pr-8"><span class="break-all"></span><div class="badge badge-sm"></div></div><div class="text-xs text-slate-500"> / <!> /<!> '),re=()=>{const[l]=q(),{rules:g,rulesProviders:b,updateRules:f,updateAllRuleProvider:_,updateRuleProviderByName:o}=V(),[R,w]=$(100),a=E(()=>g().slice(0,R()));O(f);const{map:h,setWithCallback:j}=Q(),[y,P]=$(!1),N=(n,c)=>{n.stopPropagation(),j(c,()=>o(c))},U=async n=>{n.stopPropagation(),P(!0);try{await _()}catch{}P(!1)};return(()=>{const n=Y(),c=n.firstChild,z=c.firstChild;return e(z,()=>l("rules")),e(c,r(W,{get each(){return a()},get hasMore(){return a().length<g().length},next:()=>w(R()+100),children:s=>(()=>{const d=ee(),t=d.firstChild,u=t.firstChild,i=t.nextSibling,v=i.firstChild;return e(u,()=>s.payload),e(t,r(A,{get when(){return typeof s.size=="number"&&s.size!==-1},get children(){const x=Z();return e(x,()=>s.size),x}}),null),e(i,()=>s.type,v),e(i,()=>s.proxy,null),d})()}),null),e(n,r(A,{get when(){return b().length>0},get children(){const s=X(),d=s.firstChild;return e(d,()=>l("ruleProviders"),null),e(d,r(I,{class:"btn-circle btn-sm",get disabled(){return y()},onClick:t=>U(t),get children(){return r(B,{get class(){return C(y()&&"animate-spin text-success")}})}}),null),e(s,r(D,{get each(){return b()},children:t=>(()=>{const u=te(),i=u.firstChild,v=i.firstChild,x=v.nextSibling,p=i.nextSibling,S=p.firstChild,M=S.nextSibling,F=M.nextSibling,k=F.nextSibling;return k.nextSibling,e(v,()=>t.name),e(x,()=>t.ruleCount),e(p,()=>t.vehicleType,S),e(p,()=>t.behavior,M),e(p,()=>l("updated"),k),e(p,()=>K(t.updatedAt),null),e(u,r(I,{class:"btn-circle btn-sm absolute right-2 top-2 mr-2 h-4",get disabled(){return h()[t.name]},onClick:T=>N(T,t.name),get children(){return r(B,{get class(){return C(h()[t.name]&&"animate-spin text-success")}})}}),null),u})()}),null),s}}),null),G(()=>H(n,C("flex w-full flex-col gap-4",L()&&"flex-row"))),n})()};export{re as default};
