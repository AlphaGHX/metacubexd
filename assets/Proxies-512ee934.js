import{i as d,r as S,T as C,d as M,t as $,c as x,p as G,b as m,X as q,F as f,J as A}from"./vendor-e7ea9428.js";import{t as P}from"./tw-merge-1166cefb.js";import{u as D}from"./index-48383169.js";const I=$('<div><div class="collapse-title text-xl font-medium"></div><div>'),J=l=>{const{title:p,content:g,onCollapse:u}=l,c=()=>l.isOpen?"collapse-open":"collapse-close",r=()=>l.isOpen?"opacity-100":"opacity-0 scale-y-0";return(()=>{const s=I(),o=s.firstChild,e=o.nextSibling;return o.$$click=()=>u(!l.isOpen),d(o,p),d(e,g),S(t=>{const i=P(c(),"collapse collapse-arrow border-secondary bg-base-200 p-1"),y=P(r(),"collapse-content grid grid-cols-1 gap-2 overflow-hidden transition-opacity duration-1000 sm:grid-cols-3 lg:grid-cols-5");return i!==t._v$&&C(s,t._v$=i),y!==t._v$2&&C(e,t._v$2=y),t},{_v$:void 0,_v$2:void 0}),s})()},w=J;M(["click"]);const[L,R]=x([]),[b,N]=x({}),[X,z]=x([]);function j(){const l=D(),p=async()=>{const{providers:c}=await l.get("providers/proxies").json(),r=b();Object.values(c).forEach(e=>{e.proxies.forEach(t=>{var i;r[t.name]=(i=t.history[t.history.length-1])==null?void 0:i.delay})}),N(r),z(Object.values(c).filter(e=>e.name!=="default"&&e.vehicleType!=="Compatible"));const{proxies:s}=await l.get("proxies").json(),o=s.GLOBAL.all??[];R(Object.values(s).filter(e=>e.all&&e.all.length>0).sort((e,t)=>o.indexOf(e.name)-o.indexOf(t.name)))};return{proxies:L,proxyProviders:X,delayTestByProxyGroupName:async c=>{const r=await l.get(`group/${c}/delay?url=https%3A%2F%2Fwww.gstatic.com%2Fgenerate_204&timeout=2000`).json(),s=b();Object.entries(r).forEach(([o,e])=>{s[o]=e}),N({...s})},delayMap:b,updateProxy:p,setProxiesByProxyName:async(c,r)=>{await l.put(`proxies/${c.name}`,{body:JSON.stringify({name:r})}),await p()}}}const H=$("<span>ms"),K=$('<div><span class="mr-2 overflow-hidden whitespace-nowrap"></span><span>'),O=l=>{const{proxyName:p,isSelected:g,onClick:u}=l,{delayMap:c}=j(),r=s=>{const o=c()[s];return typeof o!="number"||o===0?"":(()=>{const e=H(),t=e.firstChild;return d(e,o,t),e})()};return(()=>{const s=K(),o=s.firstChild,e=o.nextSibling;return s.$$click=()=>u==null?void 0:u(),d(o,p),d(e,()=>r(p)),S(()=>C(s,P(g?"border-primary bg-success-content text-success":"border-secondary",u?"cursor-pointer":"","card card-bordered card-compact m-1 flex-row justify-between border-secondary p-4"))),s})()};M(["click"]);const Q=$('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-1"></div></div><div><h1 class="pb-4 text-lg font-semibold">Proxy Providers</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-1">'),U=$('<div class="flex items-center"><span class="mr-3">'),V=$('<div class="text-sm text-slate-500"> :: '),ee=()=>{const{proxies:l,proxyProviders:p,updateProxy:g,setProxiesByProxyName:u,delayTestByProxyGroupName:c}=j(),[r,s]=x({});G(async()=>{await g()});const o=async(t,i)=>{u(t,i)},e=(t,i)=>{t.stopPropagation(),c(i)};return(()=>{const t=Q(),i=t.firstChild,y=i.firstChild,B=y.nextSibling,k=i.nextSibling,T=k.firstChild,E=T.nextSibling;return d(B,m(f,{get each(){return l()},children:a=>{const v=[(()=>{const n=U(),_=n.firstChild;return d(_,()=>a.name),d(n,m(q,{class:"cursor-pointer",onClick:F=>e(F,a.name)}),null),n})(),(()=>{const n=V(),_=n.firstChild;return d(n,()=>a.type,_),d(n,()=>a.now,null),n})()],h=m(f,{get each(){return a.all},children:n=>m(O,{proxyName:n,get isSelected(){return a.now===n},onClick:()=>o(a,n)})});return m(w,{get isOpen(){return r()[`group-${a.name}`]},title:v,content:h,onCollapse:n=>s({...r(),[`group-${a.name}`]:n})})}})),d(E,m(f,{get each(){return p()},children:a=>{const v=A(()=>a.name),h=m(f,{get each(){return a.proxies},children:n=>m(O,{get proxyName(){return n.name}})});return m(w,{get isOpen(){return r()[`provider-${a.name}`]},title:v,content:h,onCollapse:n=>s({...r(),[`provider-${a.name}`]:n})})}})),t})()};export{ee as default};
