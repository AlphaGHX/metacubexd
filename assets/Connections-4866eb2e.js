import{r as ge,f as C,e as M,n as m,i as a,c as s,a8 as me,a9 as H,P as q,d as D,p as T,q as v,t as S,F as y,aa as pe,ab as be,O as he,ac as R,ad as U,ae as j,af as Ce,ag as $e,G as fe,b as u,S as _e,o as ve}from"./vendor-8e04e26c.js";import{c as Se,g as ye,a as Ie,b as xe,d as we,e as Fe,f as O}from"./index-32e1e1a1.js";import{c as De,d as Te,f as Oe,g as Pe,h as l,B as I,i as Ge,j as Me,t as Re,k as Ee,m as Ke}from"./index-c2e38c1c.js";var Ne=async t=>{typeof t=="string"?await navigator.clipboard.writeText(t):await navigator.clipboard.write(t)};const ke=u("<pre><code>"),ze=u('<dialog id="connections-table-details-modal" class="modal"><div class="modal-box"></div><form method="dialog" class="modal-backdrop"><button>'),Y=u('<div class="flex h-4 items-center">'),Le=u('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class="flex w-full items-center gap-2 md:flex-1"><input type="search" class="input input-primary input-sm flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),Ae=u('<button><span></span><div class="badge badge-sm">'),Ve=u("<tr>"),Be=u('<th class="bg-base-200"><div><div>'),He=u('<button class="cursor-pointer">'),qe=u('<tr class="h-8 hover:!bg-primary hover:text-primary-content">'),Ue=u("<td>"),je=u("<button><div></div><div></div><div>(<!>)");var x=function(t){return t.activeConnections="activeConnections",t.closedConnections="closedConnections",t}(x||{});const Ye=t=>(()=>{const f=ze(),P=f.firstChild;return a(P,s(_e,{get when(){return t.selectedConnectionID},get children(){const _=ke(),w=_.firstChild;return a(w,()=>JSON.stringify(Ke.find(({id:G})=>G===t.selectedConnectionID),null,2)),_}})),f})(),Qe=()=>{const[t]=ge(),f=De(),[P,_]=C(""),[w,G]=C(x.activeConnections),{activeConnections:E,closedConnections:K,paused:Z,setPaused:J}=Te(),X=e=>f.delete(`connections/${e}`),[N,Q]=M(C(Oe),{name:"columnVisibility",storage:localStorage}),[k,W]=M(C(Pe),{name:"columnOrder",storage:localStorage}),[ee,te]=C(),ne=m(()=>[{header:()=>t("details"),enableGrouping:!1,enableSorting:!1,accessorKey:l.Details,cell:({row:e})=>(()=>{const r=Y();return a(r,s(I,{class:"btn-circle btn-xs",onClick:()=>{te(e.original.id);const $=document.querySelector("#connections-table-details-modal");$==null||$.showModal()},get children(){return s(me,{size:"16"})}})),r})()},{header:()=>t("close"),enableGrouping:!1,enableSorting:!1,accessorKey:l.Close,cell:({row:e})=>(()=>{const r=Y();return a(r,s(I,{class:"btn-circle btn-xs",onClick:()=>X(e.original.id),get children(){return s(H,{size:"16"})}})),r})()},{header:()=>t("ID"),enableGrouping:!1,accessorKey:l.ID,accessorFn:e=>e.id},{header:()=>t("type"),accessorKey:l.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>t("process"),accessorKey:l.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>t("host"),accessorKey:l.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>t("rules"),accessorKey:l.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>t("chains"),accessorKey:l.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>t("connectTime"),enableGrouping:!1,accessorKey:l.ConnectTime,accessorFn:e=>Ge(e.start),sortingFn:(e,r)=>q(e.original.start).valueOf()-q(r.original.start).valueOf()},{header:()=>t("dlSpeed"),enableGrouping:!1,accessorKey:l.DlSpeed,accessorFn:e=>`${D(e.downloadSpeed)}/s`,sortingFn:(e,r)=>e.original.downloadSpeed-r.original.downloadSpeed},{header:()=>t("ulSpeed"),enableGrouping:!1,accessorKey:l.ULSpeed,accessorFn:e=>`${D(e.uploadSpeed)}/s`,sortingFn:(e,r)=>e.original.uploadSpeed-r.original.uploadSpeed},{header:()=>t("dl"),enableGrouping:!1,accessorKey:l.Download,accessorFn:e=>D(e.download),sortingFn:(e,r)=>e.original.download-r.original.download},{header:()=>t("ul"),enableGrouping:!1,accessorKey:l.Upload,accessorFn:e=>D(e.upload),sortingFn:(e,r)=>e.original.upload-r.original.upload},{header:()=>t("sourceIP"),accessorKey:l.SourceIP,accessorFn:e=>e.metadata.sourceIP},{header:()=>t("sourcePort"),accessorKey:l.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>t("destination"),accessorKey:l.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host}]),[oe,se]=C([]),[ae,re]=M(C([{id:l.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),z=Se({state:{get columnOrder(){return k()},get grouping(){return oe()},get sorting(){return ae()},get columnVisibility(){return N()},get globalFilter(){return P()}},get data(){return w()===x.activeConnections?E():K()},sortDescFirst:!0,enableHiding:!0,columns:ne(),onGlobalFilterChange:_,onGroupingChange:se,onSortingChange:re,getFilteredRowModel:ye(),getSortedRowModel:Ie(),getExpandedRowModel:xe(),getGroupedRowModel:we(),getCoreRowModel:Fe()}),le=m(()=>[{type:x.activeConnections,name:t("activeConnections"),count:E().length},{type:x.closedConnections,name:t("closedConnections"),count:K().length}]);return(()=>{const e=Le(),r=e.firstChild,$=r.firstChild,F=$.nextSibling,L=F.firstChild,ce=r.nextSibling,A=ce.firstChild,V=A.firstChild,ie=V.nextSibling;return a($,s(y,{get each(){return le()},children:n=>(()=>{const i=Ae(),o=i.firstChild,p=o.nextSibling;return i.$$click=()=>G(n.type),a(o,()=>n.name),a(p,()=>n.count),T(()=>v(i,S(w()===n.type&&"tab-active","tab tab-sm gap-2 sm:tab-md"))),i})()})),L.$$input=n=>_(n.target.value),a(F,s(I,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>J(n=>!n),get children(){return m(()=>!!Z())()?s(pe,{}):s(be,{})}}),null),a(F,s(I,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>f.delete("connections"),get children(){return s(H,{})}}),null),a(F,s(I,{class:"btn btn-circle btn-sm sm:btn-md",onClick:()=>{const n=document.querySelector("#connections-table-ordering-modal");n==null||n.showModal()},get children(){return s(he,{})}}),null),a(V,s(y,{get each(){return z.getHeaderGroups()},children:n=>(()=>{const i=Ve();return a(i,s(y,{get each(){return n.headers},children:o=>(()=>{const p=Be(),b=p.firstChild,c=b.firstChild;return a(b,(()=>{const d=m(()=>!!o.column.getCanGroup());return()=>d()?(()=>{const g=He();return R(g,"click",o.column.getToggleGroupingHandler(),!0),a(g,(()=>{const h=m(()=>!!o.column.getIsGrouped());return()=>h()?s(U,{size:18}):s(j,{size:18})})()),g})():null})(),c),R(c,"click",o.column.getToggleSortingHandler(),!0),a(c,()=>O(o.column.columnDef.header,o.getContext())),a(b,()=>({asc:s(Ce,{}),desc:s($e,{})})[o.column.getIsSorted()]??null,null),T(d=>{const g=S("flex items-center gap-2"),h=S(o.column.getCanSort()&&"cursor-pointer select-none","flex-1");return g!==d._v$3&&v(b,d._v$3=g),h!==d._v$4&&v(c,d._v$4=h),d},{_v$3:void 0,_v$4:void 0}),p})()})),i})()})),a(ie,s(y,{get each(){return z.getRowModel().rows},children:n=>(()=>{const i=qe();return a(i,s(y,{get each(){return n.getVisibleCells()},children:o=>(()=>{const p=Ue();return p.$$contextmenu=b=>{b.preventDefault();const c=o.renderValue();c&&Ne(c).catch(()=>{})},a(p,(()=>{const b=m(()=>!!o.getIsGrouped());return()=>b()?(()=>{const c=je(),d=c.firstChild,g=d.nextSibling,h=g.nextSibling,de=h.firstChild,B=de.nextSibling;return B.nextSibling,R(c,"click",n.getToggleExpandedHandler(),!0),a(d,(()=>{const ue=m(()=>!!n.getIsExpanded());return()=>ue()?s(U,{size:18}):s(j,{size:18})})()),a(g,()=>O(o.column.columnDef.cell,o.getContext())),a(h,()=>n.subRows.length,B),T(()=>v(c,S(n.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),c})():(()=>{const c=m(()=>!!o.getIsAggregated());return()=>c()?O(o.column.columnDef.aggregatedCell??o.column.columnDef.cell,o.getContext()):(()=>{const d=m(()=>!!o.getIsPlaceholder());return()=>d()?null:O(o.column.columnDef.cell,o.getContext())})()})()})()),p})()})),i})()})),a(e,s(Me,{get order(){return k()},get visible(){return N()},onOrderChange:n=>W(n),onVisibleChange:n=>Q({...n})}),null),a(e,s(Ye,{get selectedConnectionID(){return ee()}}),null),T(n=>{const i=t("search"),o=S(Re(Ee()),"table table-zebra relative rounded-none");return i!==n._v$&&fe(L,"placeholder",n._v$=i),o!==n._v$2&&v(A,n._v$2=o),n},{_v$:void 0,_v$2:void 0}),e})()};ve(["input","click","contextmenu"]);export{Qe as default};
