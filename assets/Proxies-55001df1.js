import{i,f as F,t as w,g as h,d as S,h as y,c as v,L as G,s as R,v as J,b as g,Y,F as b}from"./vendor-eb80b34a.js";import{u as z}from"./index-2f7ab1df.js";const H=y('<div><div class="collapse-title text-xl font-medium"></div><div>'),K=r=>{const{title:p,content:f,onCollapse:x}=r,c=()=>{const s="collapse-open",l="collapse-close";return r.isOpen?s:l},o=()=>{const s="opacity-100",l="opacity-0";return r.isOpen?s:l};return(()=>{const s=H(),l=s.firstChild,n=l.nextSibling;return l.$$click=()=>x(!r.isOpen),i(l,p),i(n,f),F(e=>{const t=w(c(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),u=w(o(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return t!==e._v$&&h(s,e._v$=t),u!==e._v$2&&h(n,e._v$2=u),e},{_v$:void 0,_v$2:void 0}),s})()},k=K;S(["click"]);const[Q,U]=v([]),[V,W]=v([]),[N,B]=v({}),[T,X]=v({});function L(){const r=z(),p=async()=>{const{providers:c}=await r.get("providers/proxies").json(),o=N();Object.values(c).forEach(n=>{n.proxies.forEach(e=>{var t;X({...T(),[e.name]:e}),o[e.name]=(t=e.history[e.history.length-1])==null?void 0:t.delay})}),B(o),W(Object.values(c).filter(n=>n.name!=="default"&&n.vehicleType!=="Compatible"));const{proxies:s}=await r.get("proxies").json(),l=s.GLOBAL.all??[];U(Object.values(s).filter(n=>n.all&&n.all.length>0).sort((n,e)=>l.indexOf(n.name)-l.indexOf(e.name)))};return{proxies:Q,proxyProviders:V,delayTestByProxyGroupName:async c=>{const o=await r.get(`group/${c}/delay?url=https%3A%2F%2Fwww.gstatic.com%2Fgenerate_204&timeout=2000`).json(),s=N();Object.entries(o).forEach(([l,n])=>{s[l]=n}),B({...s})},proxyNodeMap:T,delayMap:N,updateProxy:p,setProxiesByProxyName:async(c,o)=>{await r.put(`proxies/${c.name}`,{body:JSON.stringify({name:o})}),await p()}}}const Z=y("<span>ms"),ee=y('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div class="truncate text-xs text-slate-500"></div><div class="text-xs">'),E=r=>{const{proxyName:p,isSelected:f,onClick:x}=r,{delayMap:c,proxyNodeMap:o}=L(),s=G(()=>o()[p]),l=e=>{const t=c()[e];if(typeof t!="number"||t===0)return"";let u="text-green-500";return t>500?u="text-red-500":t>200&&(u="text-yellow-500"),(()=>{const m=Z(),$=m.firstChild;return h(m,u),i(m,t,$),m})()},n=e=>{const t=e.toLowerCase();return t==="shadowsocks"?"ss":t};return(()=>{const e=ee(),t=e.firstChild,u=t.nextSibling,m=u.firstChild,$=m.nextSibling;return e.$$click=()=>x==null?void 0:x(),R(e,"data-tip",p),i(t,p),i(m,()=>n(s().type),null),i(m,()=>s().udp?" :: udp":"",null),i($,()=>l(p)),F(()=>h(e,w("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 p-4",f?"border-primary bg-success-content text-success":"border-secondary",x&&"cursor-pointer"))),e})()};S(["click"]);const te=y('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2"></div></div><div><h1 class="pb-4 text-lg font-semibold">Proxy Providers</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),se=y('<div class="flex items-center justify-between"><div class="flex flex-col"><span></span><div class="text-sm text-slate-500"> :: </div></div><button class="btn btn-circle btn-sm">'),oe=()=>{const{proxies:r,proxyProviders:p,updateProxy:f,setProxiesByProxyName:x,delayTestByProxyGroupName:c}=L(),[o,s]=v({});J(async()=>{await f()});const l=async(e,t)=>{x(e,t)},n=(e,t)=>{e.stopPropagation(),c(t)};return(()=>{const e=te(),t=e.firstChild,u=t.firstChild,m=u.nextSibling,$=t.nextSibling,A=$.firstChild,q=A.nextSibling;return i(m,g(b,{get each(){return r()},children:a=>{const _=(()=>{const d=se(),O=d.firstChild,M=O.firstChild,P=M.nextSibling,D=P.firstChild,j=O.nextSibling;return i(M,()=>a.name),i(P,()=>a.type,D),i(P,()=>a.now,null),j.$$click=I=>n(I,a.name),i(j,g(Y,{})),d})(),C=g(b,{get each(){return a.all},children:d=>g(E,{proxyName:d,get isSelected(){return a.now===d},onClick:()=>l(a,d)})});return g(k,{get isOpen(){return o()[`group-${a.name}`]},title:_,content:C,onCollapse:d=>s({...o(),[`group-${a.name}`]:d})})}})),i(q,g(b,{get each(){return p()},children:a=>{const _=G(()=>a.name),C=g(b,{get each(){return a.proxies},children:d=>g(E,{get proxyName(){return d.name}})});return g(k,{get isOpen(){return o()[`provider-${a.name}`]},title:_,content:C,onCollapse:d=>s({...o(),[`provider-${a.name}`]:d})})}})),e})()};S(["click"]);export{oe as default};
