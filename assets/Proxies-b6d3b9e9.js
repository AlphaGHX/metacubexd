import{i,f as L,t as B,g as N,d as j,h as v,c as C,L as U,s as J,v as Y,b as m,Y as Z,F as P,Z as z}from"./vendor-6f12c8cd.js";import{u as H}from"./index-68c50312.js";const K=v('<div><div class="collapse-title text-xl font-medium"></div><div>'),Q=c=>{const{title:p,content:$,onCollapse:x}=c,f=()=>{const s="collapse-open",l="collapse-close";return c.isOpen?s:l},d=()=>{const s="opacity-100",l="opacity-0";return c.isOpen?s:l};return(()=>{const s=K(),l=s.firstChild,u=l.nextSibling;return l.$$click=()=>x(!c.isOpen),i(l,p),i(u,$),L(e=>{const t=B(f(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),n=B(d(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return t!==e._v$&&N(s,e._v$=t),n!==e._v$2&&N(u,e._v$2=n),e},{_v$:void 0,_v$2:void 0}),s})()},G=Q;j(["click"]);const[V,W]=C([]),[X,ee]=C([]),[k,T]=C({}),[E,te]=C({});function A(){const c=H(),p=async()=>{const{providers:d}=await c.get("providers/proxies").json(),s=k();Object.values(d).forEach(e=>{e.proxies.forEach(t=>{var n;te({...E(),[t.name]:t}),s[t.name]=(n=t.history[t.history.length-1])==null?void 0:n.delay})}),T(s),ee(Object.values(d).filter(e=>e.name!=="default"&&e.vehicleType!=="Compatible"));const{proxies:l}=await c.get("proxies").json(),u=l.GLOBAL.all??[];W(Object.values(l).filter(e=>e.all&&e.all.length>0).sort((e,t)=>u.indexOf(e.name)-u.indexOf(t.name)))};return{proxies:V,proxyProviders:X,delayTestByProxyGroupName:async d=>{const s=await c.get(`group/${d}/delay?url=https%3A%2F%2Fwww.gstatic.com%2Fgenerate_204&timeout=2000`).json(),l=k();Object.entries(s).forEach(([u,e])=>{l[u]=e}),T({...l})},proxyNodeMap:E,delayMap:k,updateProxy:p,setProxyGroupByProxyName:async(d,s)=>{await c.put(`proxies/${d.name}`,{body:JSON.stringify({name:s})}),await p()},updateProxyProviderByProviderName:async d=>{await c.put(`/providers/proxies/${d}`),await p()}}}const se=v("<span>ms"),ne=v('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div class="truncate text-xs text-slate-500"></div><div class="text-xs">'),F=c=>{const{proxyName:p,isSelected:$,onClick:x}=c,{delayMap:f,proxyNodeMap:d}=A(),s=U(()=>d()[p]),l=e=>{const t=f()[e];if(typeof t!="number"||t===0)return"";let n="text-green-500";return t>500?n="text-red-500":t>200&&(n="text-yellow-500"),(()=>{const o=se(),y=o.firstChild;return N(o,n),i(o,t,y),o})()},u=e=>{const t=e.toLowerCase();return t==="shadowsocks"?"ss":t};return(()=>{const e=ne(),t=e.firstChild,n=t.nextSibling,o=n.firstChild,y=o.nextSibling;return e.$$click=()=>x==null?void 0:x(),J(e,"data-tip",p),i(t,p),i(o,()=>u(s().type),null),i(o,()=>s().udp&&" :: udp",null),i(y,()=>l(p)),L(()=>N(e,B("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 p-4",$?"border-primary bg-success-content text-success":"border-secondary",x&&"cursor-pointer"))),e})()};j(["click"]);const le=v('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2"></div></div><div><h1 class="pb-4 text-lg font-semibold">Proxy Providers</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),oe=v('<div class="flex items-center justify-between"><div class="flex flex-col"><span></span><div class="text-sm text-slate-500"> :: </div></div><button class="btn btn-circle btn-sm">'),ae=v('<div class="flex items-center justify-between"><div class="flex flex-col"><span></span><div class="text-sm text-slate-500"> :: Updated at </div></div><button class="btn btn-circle btn-sm">'),ce=()=>{const{proxies:c,proxyProviders:p,updateProxy:$,setProxyGroupByProxyName:x,delayTestByProxyGroupName:f,updateProxyProviderByProviderName:d}=A(),[s,l]=C({});Y(async()=>{await $()});const u=async(n,o)=>{x(n,o)},e=(n,o)=>{n.stopPropagation(),f(o)},t=(n,o)=>{n.stopPropagation(),d(o)};return(()=>{const n=le(),o=n.firstChild,y=o.firstChild,D=y.nextSibling,I=o.nextSibling,R=I.firstChild,q=R.nextSibling;return i(D,m(P,{get each(){return c()},children:a=>{const w=(()=>{const r=oe(),b=r.firstChild,_=b.firstChild,g=_.nextSibling,O=g.firstChild,h=b.nextSibling;return i(_,()=>a.name),i(g,()=>a.type,O),i(g,()=>a.now,null),h.$$click=M=>e(M,a.name),i(h,m(Z,{})),r})(),S=m(P,{get each(){return a.all},children:r=>m(F,{proxyName:r,get isSelected(){return a.now===r},onClick:()=>u(a,r)})});return m(G,{get isOpen(){return s()[`group-${a.name}`]},title:w,content:S,onCollapse:r=>l({...s(),[`group-${a.name}`]:r})})}})),i(q,m(P,{get each(){return p()},children:a=>{const w=(()=>{const r=ae(),b=r.firstChild,_=b.firstChild,g=_.nextSibling,O=g.firstChild,h=b.nextSibling;return i(_,()=>a.name),i(g,()=>a.vehicleType,O),i(g,()=>new Date(a.updatedAt).toLocaleString(),null),h.$$click=M=>t(M,a.name),i(h,m(z,{})),r})(),S=m(P,{get each(){return a.proxies},children:r=>m(F,{get proxyName(){return r.name}})});return m(G,{get isOpen(){return s()[`provider-${a.name}`]},title:w,content:S,onCollapse:r=>l({...s(),[`provider-${a.name}`]:r})})}})),n})()};j(["click"]);export{ce as default};
