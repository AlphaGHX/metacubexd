import{c as $,p as q,f as O,E as W,i as t,h as r,F as D,j as G,n as H,t as w,S as f,ai as B,ah as J,o as g,g as K}from"./vendor-1082ac4c.js";import{B as j}from"./Button-6cdc8c17.js";import{f as L,i as Q}from"./index-8e8bd3c2.js";import{F as V}from"./ForTwoColumns-5030d4b9.js";import{u as X}from"./global-6c188e99.js";const Y=()=>{const l=L(),[m,b]=$([]),[x,y]=$([]),h=async()=>{const[{rules:i},{providers:_}]=await Promise.all([l.get("rules").json(),l.get("providers/rules").json()]);b(Object.values(i)),y(Object.values(_))};return{rules:m,ruleProviders:x,updateRules:h,updateAllRuleProvider:async()=>{await Promise.all(x().map(i=>l.put(`providers/rules/${i.name}`))),await h()},updateRuleProviderByName:async i=>{await l.put(`providers/rules/${i}`),await h()}}},Z=g('<div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2">'),ee=g('<div class="flex h-full flex-col gap-2"><div class="flex-1 overflow-y-auto">'),te=g('<button><span></span><div class="badge badge-sm">'),se=g('<div class="card card-bordered card-compact mb-2 bg-base-200 p-4"><div class="flex items-center gap-2 pr-8"><span class="break-all"></span><div class="badge badge-sm"></div></div><div class="text-xs text-slate-500"> / <!> /<!> '),le=g('<div class="badge badge-sm">'),re=g('<div class="card card-bordered card-compact mb-2 bg-base-200 p-4"><div class="flex items-center gap-2"><span class="break-all"></span></div><div class="text-xs text-slate-500"> :: ');var d=function(l){return l.ruleProviders="ruleProviders",l.rules="rules",l}(d||{});const ue=()=>{const[l]=q(),{rules:m,ruleProviders:b,updateRules:x,updateAllRuleProvider:y,updateRuleProviderByName:h}=Y(),[C,P]=$(100),i=O(()=>m().slice(0,C()));W(x);const{map:_,setWithCallback:F}=X(),[S,k]=$(!1),I=(u,p)=>{u.stopPropagation(),F(p,()=>h(p))},N=async u=>{u.stopPropagation(),k(!0);try{await y()}catch{}k(!1)},[R,U]=$(d.rules),T=()=>[{type:d.rules,name:l("rules"),count:m().length},{type:d.ruleProviders,name:l("ruleProviders"),count:b().length}];return(()=>{const u=ee(),p=u.firstChild;return t(u,r(f,{get when(){return b().length>0},get children(){const e=Z(),c=e.firstChild;return t(c,r(D,{get each(){return T()},children:s=>(()=>{const a=te(),o=a.firstChild,n=o.nextSibling;return a.$$click=()=>U(s.type),t(o,()=>s.name),t(n,()=>s.count),G(()=>H(a,w(R()===s.type&&"tab-active","tab gap-2 px-2"))),a})()})),t(e,r(f,{get when(){return R()===d.ruleProviders},get children(){return r(j,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:s=>N(s),get children(){return r(B,{get class(){return w(S()&&"animate-spin text-success")}})}})}}),null),e}}),p),t(p,r(f,{get when(){return R()===d.ruleProviders},get children(){return r(V,{get subChild(){return b().map(e=>(()=>{const c=se(),s=c.firstChild,a=s.firstChild,o=a.nextSibling,n=s.nextSibling,v=n.firstChild,M=v.nextSibling,z=M.nextSibling,A=z.nextSibling;return A.nextSibling,t(a,()=>e.name),t(o,()=>e.ruleCount),t(n,()=>e.vehicleType,v),t(n,()=>e.behavior,M),t(n,()=>l("updated"),A),t(n,()=>Q(e.updatedAt),null),t(c,r(j,{class:"btn-circle btn-sm absolute right-2 top-2 mr-2 h-4",get disabled(){return _()[e.name]},onClick:E=>I(E,e.name),get children(){return r(B,{get class(){return w(_()[e.name]&&"animate-spin text-success")}})}}),null),c})())}})}}),null),t(p,r(f,{get when(){return R()===d.rules},get children(){return r(J,{get each(){return i()},get hasMore(){return i().length<m().length},next:()=>P(C()+100),children:e=>(()=>{const c=re(),s=c.firstChild,a=s.firstChild,o=s.nextSibling,n=o.firstChild;return t(a,()=>e.payload),t(s,r(f,{get when(){return typeof e.size=="number"&&e.size!==-1},get children(){const v=le();return t(v,()=>e.size),v}}),null),t(o,()=>e.type,n),t(o,()=>e.proxy,null),c})()})}}),null),u})()};K(["click"]);export{ue as default};
