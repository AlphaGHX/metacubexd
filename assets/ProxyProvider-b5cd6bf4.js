import{ac as Y,a as m,i,e as l,S as M,h as f,c as A,ad as z,f as L,F as W,g as Q,t as T,b as F,y as V,u as X,ae as H,ab as q}from"./vendor-bb973e4f.js";import{B as D}from"./Button-f3342b78.js";import{l as J,P as K,m as I,n as N,i as B,o as $,L as R,j as Z,p as ee,h as te,k as ne}from"./index-d51853b2.js";import{u as O}from"./global-228b6594.js";const le=f('<div class="ml-2 flex flex-1 flex-col">'),se=f('<div class="flex"><div class="flex flex-1 flex-col">'),re=e=>{const n=Y(),t=m(()=>n.width>=640&&J()),r=m(()=>e.subChild.filter((a,c)=>c%2===0||!t())),s=m(()=>e.subChild.filter((a,c)=>c%2===1));return(()=>{const a=se(),c=a.firstChild;return i(c,r),i(a,l(M,{get when(){return t()},get children(){const _=le();return i(_,s),_}}),null),a})()},ae=e=>{const[n,t]=A(100),r=m(()=>e.proxyNames.slice(0,n()));return l(z,{get each(){return r()},get hasMore(){return r().length<e.proxyNames.length},next:()=>t(n()+30),children:s=>l(K,{proxyName:s,get isSelected(){return e.now===s},onClick:()=>{var a;(a=e.onClick)==null||a.call(e,s)}})})},ie=e=>{const n=()=>I()===N.OFF,t=m(()=>e.proxyNameList.length<=30),r=m(()=>{const a=I();return a===N.BAR||a===N.Auto&&!t()}),s=m(()=>{const a=I();return a===N.DOTS||a===N.Auto&&t()});return l(M,{get when(){return!n()},get children(){return[l(M,{get when(){return r()},get children(){return l(ce,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),l(M,{get when(){return s()},get children(){return l(ge,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},oe=f('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),ce=e=>{const{latencyMap:n}=B(),t=m(()=>e.proxyNameList.map(o=>n()[o])),r=m(()=>t().length),s=m(()=>t().filter(o=>o>$().NOT_CONNECTED&&o<=$().MEDIUM).length),a=m(()=>t().filter(o=>o>$().MEDIUM&&o<=$().HIGH).length),c=m(()=>t().filter(o=>o>$().HIGH).length),_=m(()=>t().filter(o=>o===$().NOT_CONNECTED).length);return(()=>{const o=oe(),E=o.firstChild,b=E.firstChild,y=b.nextSibling,w=y.nextSibling,p=w.nextSibling;return i(o,l(R,{get name(){return e.now}}),null),L(x=>{const v=`${s()*100/r()}%`,C=`${a()*100/r()}%`,u=`${c()*100/r()}%`,g=`${_()*100/r()}%`;return v!==x._v$&&((x._v$=v)!=null?b.style.setProperty("width",v):b.style.removeProperty("width")),C!==x._v$2&&((x._v$2=C)!=null?y.style.setProperty("width",C):y.style.removeProperty("width")),u!==x._v$3&&((x._v$3=u)!=null?w.style.setProperty("width",u):w.style.removeProperty("width")),g!==x._v$4&&((x._v$4=g)!=null?p.style.setProperty("width",g):p.style.removeProperty("width")),x},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),o})()},de=f("<div>"),ue=f('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),me=e=>{let n=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===$().NOT_CONNECTED?n=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>$().HIGH?n=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>$().MEDIUM&&(n=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const t=de();return L(()=>Q(t,T("m-1 h-4 w-4 rounded-full",n))),t})()},ge=e=>{const{latencyMap:n}=B();return(()=>{const t=ue(),r=t.firstChild;return i(r,l(W,{get each(){return e.proxyNameList.map(s=>[s,n()[s]])},children:([s,a])=>{const c=e.now===s;return l(me,{latency:a,selected:c})}})),i(t,l(R,{get name(){return e.now}}),null),t})()},he=f('<progress class="progress" max="100">'),xe=f('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),fe=f('<div class="text-sm text-slate-500">Expire: <!> '),$e=e=>{const n=F(e.Total,{units:"iec"}),t=F(e.Download+e.Upload,{units:"iec"}),r=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:n,used:t,percentage:r,expireStr:()=>e.Expire===0?"Null":V(e.Expire*1e3).format("YYYY-MM-DD")}},_e=e=>{if(!e.subscriptionInfo)return;const n=$e(e.subscriptionInfo);return[(()=>{const t=he();return L(()=>t.value=n.percentage),t})(),(()=>{const t=xe(),r=t.firstChild,s=r.nextSibling,a=s.nextSibling,c=a.nextSibling;return c.nextSibling,i(t,()=>`${n.used}`,r),i(t,()=>`${n.total}`,s),i(t,()=>n.percentage,c),t})(),(()=>{const t=fe(),r=t.firstChild,s=r.nextSibling;return s.nextSibling,i(t,()=>n.expireStr(),s),t})()]},be=f('<div class="flex flex-col gap-2"><h1 class="flex h-8 items-center pb-2 text-lg font-semibold">'),ye=f('<div class="mr-8 flex items-center justify-between"><span></span><div>'),we=f('<div class="text-sm text-slate-500"> :: <!> '),pe=()=>{const[e]=X(),{proxyProviders:n,updateProviderByProviderName:t,updateAllProvider:r,healthCheckByProviderName:s,latencyMap:a}=B(),{map:c,set:_}=O(),{map:o,setWithCallback:E}=O(),{map:b,setWithCallback:y}=O(),[w,p]=A(!1),x=(u,g)=>{u.stopPropagation(),E(g,()=>s(g))},v=(u,g)=>{u.stopPropagation(),y(g,()=>t(g))},C=async u=>{u.stopPropagation(),p(!0);try{await r()}catch{}p(!1)};return(()=>{const u=be(),g=u.firstChild;return i(g,()=>e("proxyProviders"),null),i(g,l(D,{class:"btn-circle btn-ghost btn-sm ml-2",onClick:d=>C(d),get children(){return l(H,{get class(){return T(w()&&"animate-spin text-success")}})}}),null),i(u,l(re,{get subChild(){return n().map(d=>{const U=Z(d.proxies.map(h=>h.name)??[],a(),ee()),j=[(()=>{const h=ye(),S=h.firstChild,P=S.nextSibling;return i(S,()=>d.name),i(P,l(D,{class:"btn btn-circle btn-sm mr-2",onClick:k=>v(k,d.name),get children(){return l(H,{get class(){return T(b()[d.name]&&"animate-spin text-success")}})}}),null),i(P,l(D,{class:"btn btn-circle btn-sm",onClick:k=>x(k,d.name),get children(){return l(q,{get class(){return T(o()[d.name]&&"animate-pulse text-success")}})}}),null),h})(),l(_e,{get subscriptionInfo(){return d.subscriptionInfo}}),(()=>{const h=we(),S=h.firstChild,P=S.nextSibling;return P.nextSibling,i(h,()=>d.vehicleType,S),i(h,()=>e("updated"),P),i(h,()=>te(d.updatedAt),null),h})(),l(M,{get when(){return!c()[d.name]},get children(){return l(ie,{proxyNameList:U})}})],G=l(ae,{proxyNames:U});return l(ne,{get isOpen(){return c()[d.name]},title:j,content:G,onCollapse:h=>_(d.name,h)})})}}),null),u})()},Ne=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{re as F,ie as P,ae as a,pe as b,Ne as c};
