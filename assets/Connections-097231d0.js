import{p as ne,c as x,i as o,h as n,$ as $e,a0 as pe,a1 as Ce,F as P,a2 as ve,S as se,a3 as _e,o as i,a4 as fe,a5 as Se,Q as xe,j as E,m as H,f as v,a6 as ye,a7 as Q,C as X,b as V,n as K,t as M,a8 as Ie,a9 as we,B as De,aa as j,ab as W,ac as ee,ad as Fe,ae as Oe,s as Pe,g as Te}from"./vendor-1082ac4c.js";import{c as Ee,g as Re,a as ke,b as Ke,d as Me,e as Ge,f as B}from"./index-7f9611a8.js";import{B as T}from"./Button-6cdc8c17.js";import{c as oe,d as ae,f as Ne,g as Le,h as l,i as ze,t as Ae,j as Ve,k as Be}from"./index-8416a89c.js";const He=i('<div class="sortable"><div class="m-1 flex cursor-grab justify-between p-1"><span class="select-none"></span><input type="checkbox" class="toggle">'),je=i('<div class="column self-stretch">'),qe=i('<div class="sortable">'),Ue=i('<dialog id="connections-table-ordering-modal" class="modal"><div class="modal-box w-80"></div><form method="dialog" class="modal-backdrop"><button>'),Ye=t=>{const[$]=ne(),[D,y]=x(null),F=({draggable:c})=>y(c.id),R=({draggable:c,droppable:h})=>{if(c&&h){const u=t.order,m=u.indexOf(c.id),I=u.indexOf(h.id);if(m!==I){const _=u.slice();_.splice(I,0,..._.splice(m,1)),t.onOrderChange(_)}}},N=({key:c})=>{const h=fe(c),[u]=Se();return(()=>{const m=He(),I=m.firstChild,_=I.firstChild,k=_.nextSibling;return xe(h,m,()=>!0),o(_,()=>$(c)),k.addEventListener("change",p=>{t.onVisibleChange({...t.visible,[c]:p.target.checked})}),E(p=>{const L=!!h.isActiveDraggable,z=!!u.active.draggable;return L!==p._v$&&m.classList.toggle("opacity-25",p._v$=L),z!==p._v$2&&m.classList.toggle("transition-transform",p._v$2=z),p},{_v$:void 0,_v$2:void 0}),E(()=>k.checked=t.visible[c]),m})()};return(()=>{const c=Ue(),h=c.firstChild;return o(h,n(_e,{onDragStart:F,onDragEnd:R,collisionDetector:$e,get children(){return[n(pe,{}),(()=>{const u=je();return o(u,n(Ce,{get ids(){return t.order},get children(){return n(P,{get each(){return t.order},children:m=>n(N,{key:m})})}})),u})(),n(ve,{get children(){return n(se,{get when(){return D()},get children(){const u=qe();return o(u,()=>$(D())),u}})}})]}}),null),o(h,n(T,{class:"btn-neutral btn-sm ml-auto mt-4 block",onClick:()=>{t.onOrderChange(oe),t.onVisibleChange(ae)},get children(){return $("reset")}}),null),c})()};var Ze=async t=>{typeof t=="string"?await navigator.clipboard.writeText(t):await navigator.clipboard.write(t)};const Je=i("<pre><code>"),Qe=i('<dialog id="connections-table-details-modal" class="modal"><div class="modal-box"></div><form method="dialog" class="modal-backdrop"><button>'),te=i('<div class="flex h-4 items-center">'),Xe=i('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class="flex w-full items-center gap-2 md:flex-1"><input class="input input-primary input-sm flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),We=i('<button><span></span><div class="badge badge-sm">'),et=i("<tr>"),tt=i('<th class="bg-base-200"><div><div>'),nt=i('<button class="cursor-pointer">'),st=i('<tr class="h-8 hover:!bg-primary hover:text-primary-content">'),ot=i("<td>"),at=i("<button><div></div><div></div><div>(<!>)");var G=function(t){return t.activeConnections="activeConnections",t.closedConnections="closedConnections",t}(G||{});const rt=t=>(()=>{const $=Qe(),D=$.firstChild;return o(D,n(se,{get when(){return t.selectedConnectionID},get children(){const y=Je(),F=y.firstChild;return o(F,()=>JSON.stringify(Be.find(({id:R})=>R===t.selectedConnectionID),null,2)),y}})),$})(),ut=()=>{const[t]=ne(),$=Ne(),[D,y]=x(""),[F,R]=x(G.activeConnections),{activeConnections:N,closedConnections:c,paused:h,setPaused:u}=Le(),m=e=>$.delete(`connections/${e}`),[I,_]=H(x(ae),{name:"columnVisibility",storage:localStorage}),[k,p]=H(x(oe),{name:"columnOrder",storage:localStorage}),[L,z]=x(),re=v(()=>[{header:()=>t("details"),enableGrouping:!1,enableSorting:!1,accessorKey:l.Details,cell:({row:e})=>(()=>{const r=te();return o(r,n(T,{class:"btn-circle btn-xs",onClick:()=>{z(e.original.id);const O=document.querySelector("#connections-table-details-modal");O==null||O.showModal()},get children(){return n(ye,{size:"16"})}})),r})()},{header:()=>t("close"),enableGrouping:!1,enableSorting:!1,accessorKey:l.Close,cell:({row:e})=>(()=>{const r=te();return o(r,n(T,{class:"btn-circle btn-xs",onClick:()=>m(e.original.id),get children(){return n(Q,{size:"16"})}})),r})()},{header:()=>t("ID"),enableGrouping:!1,accessorKey:l.ID,accessorFn:e=>e.id},{header:()=>t("type"),accessorKey:l.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>t("process"),accessorKey:l.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>t("host"),accessorKey:l.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>t("rules"),accessorKey:l.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>t("chains"),accessorKey:l.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>t("connectTime"),enableGrouping:!1,accessorKey:l.ConnectTime,accessorFn:e=>ze(e.start),sortingFn:(e,r)=>X(e.original.start).valueOf()-X(r.original.start).valueOf()},{header:()=>t("dlSpeed"),enableGrouping:!1,accessorKey:l.DlSpeed,accessorFn:e=>`${V(e.downloadSpeed)}/s`,sortingFn:(e,r)=>e.original.downloadSpeed-r.original.downloadSpeed},{header:()=>t("ulSpeed"),enableGrouping:!1,accessorKey:l.ULSpeed,accessorFn:e=>`${V(e.uploadSpeed)}/s`,sortingFn:(e,r)=>e.original.uploadSpeed-r.original.uploadSpeed},{header:()=>t("dl"),enableGrouping:!1,accessorKey:l.Download,accessorFn:e=>V(e.download),sortingFn:(e,r)=>e.original.download-r.original.download},{header:()=>t("ul"),enableGrouping:!1,accessorKey:l.Upload,accessorFn:e=>V(e.upload),sortingFn:(e,r)=>e.original.upload-r.original.upload},{header:()=>t("sourceIP"),accessorKey:l.SourceIP,accessorFn:e=>e.metadata.sourceIP},{header:()=>t("sourcePort"),accessorKey:l.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>t("destination"),accessorKey:l.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host}]),[le,ce]=x([]),[ie,de]=H(x([{id:l.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),q=Ee({state:{get columnOrder(){return k()},get grouping(){return le()},get sorting(){return ie()},get columnVisibility(){return I()},get globalFilter(){return D()}},get data(){return F()===G.activeConnections?N():c()},sortDescFirst:!0,enableHiding:!0,columns:re(),onGlobalFilterChange:y,onGroupingChange:ce,onSortingChange:de,getFilteredRowModel:Re(),getSortedRowModel:ke(),getExpandedRowModel:Ke(),getGroupedRowModel:Me(),getCoreRowModel:Ge()}),ue=v(()=>[{type:G.activeConnections,name:t("activeConnections"),count:N().length},{type:G.closedConnections,name:t("closedConnections"),count:c().length}]);return(()=>{const e=Xe(),r=e.firstChild,O=r.firstChild,A=O.nextSibling,U=A.firstChild,ge=r.nextSibling,Y=ge.firstChild,Z=Y.firstChild,me=Z.nextSibling;return o(O,n(P,{get each(){return ue()},children:s=>(()=>{const g=We(),a=g.firstChild,f=a.nextSibling;return g.$$click=()=>R(s.type),o(a,()=>s.name),o(f,()=>s.count),E(()=>K(g,M(F()===s.type&&"tab-active","tab tab-sm gap-2 sm:tab-md"))),g})()})),U.$$input=s=>y(s.target.value),o(A,n(T,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>u(s=>!s),get children(){return v(()=>!!h())()?n(Ie,{}):n(we,{})}}),null),o(A,n(T,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>$.delete("connections"),get children(){return n(Q,{})}}),null),o(A,n(T,{class:"btn btn-circle btn-sm sm:btn-md",onClick:()=>{const s=document.querySelector("#connections-table-ordering-modal");s==null||s.showModal()},get children(){return n(De,{})}}),null),o(Z,n(P,{get each(){return q.getHeaderGroups()},children:s=>(()=>{const g=et();return o(g,n(P,{get each(){return s.headers},children:a=>(()=>{const f=tt(),S=f.firstChild,d=S.firstChild;return o(S,(()=>{const b=v(()=>!!a.column.getCanGroup());return()=>b()?(()=>{const C=nt();return j(C,"click",a.column.getToggleGroupingHandler(),!0),o(C,(()=>{const w=v(()=>!!a.column.getIsGrouped());return()=>w()?n(W,{size:18}):n(ee,{size:18})})()),C})():null})(),d),j(d,"click",a.column.getToggleSortingHandler(),!0),o(d,()=>B(a.column.columnDef.header,a.getContext())),o(S,()=>({asc:n(Fe,{}),desc:n(Oe,{})})[a.column.getIsSorted()]??null,null),E(b=>{const C=M("flex items-center gap-2"),w=M(a.column.getCanSort()&&"cursor-pointer select-none","flex-1");return C!==b._v$3&&K(S,b._v$3=C),w!==b._v$4&&K(d,b._v$4=w),b},{_v$3:void 0,_v$4:void 0}),f})()})),g})()})),o(me,n(P,{get each(){return q.getRowModel().rows},children:s=>(()=>{const g=st();return o(g,n(P,{get each(){return s.getVisibleCells()},children:a=>(()=>{const f=ot();return f.$$contextmenu=S=>{S.preventDefault();const d=a.renderValue();d&&Ze(d).catch(()=>{})},o(f,(()=>{const S=v(()=>!!a.getIsGrouped());return()=>S()?(()=>{const d=at(),b=d.firstChild,C=b.nextSibling,w=C.nextSibling,be=w.firstChild,J=be.nextSibling;return J.nextSibling,j(d,"click",s.getToggleExpandedHandler(),!0),o(b,(()=>{const he=v(()=>!!s.getIsExpanded());return()=>he()?n(W,{size:18}):n(ee,{size:18})})()),o(C,()=>B(a.column.columnDef.cell,a.getContext())),o(w,()=>s.subRows.length,J),E(()=>K(d,M(s.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),d})():(()=>{const d=v(()=>!!a.getIsAggregated());return()=>d()?B(a.column.columnDef.aggregatedCell??a.column.columnDef.cell,a.getContext()):(()=>{const b=v(()=>!!a.getIsPlaceholder());return()=>b()?null:B(a.column.columnDef.cell,a.getContext())})()})()})()),f})()})),g})()})),o(e,n(Ye,{get order(){return k()},get visible(){return I()},onOrderChange:s=>p(s),onVisibleChange:s=>_({...s})}),null),o(e,n(rt,{get selectedConnectionID(){return L()}}),null),E(s=>{const g=t("search"),a=M(Ae(Ve()),"table table-zebra relative rounded-none");return g!==s._v$&&Pe(U,"placeholder",s._v$=g),a!==s._v$2&&K(Y,s._v$2=a),s},{_v$:void 0,_v$2:void 0}),e})()};Te(["input","click","contextmenu"]);export{ut as default};
