import{s as we,a as be,m as $e,t as _,i as m,c as o,S as k,b as f,d as y,e as g,k as De,f as q,g as b,h as P,j as N,u as te,l as Ce,n as re,I as _e,A as oe,F as H,o as Pe,p as Ne,q as j,r as ke,v as Le,w as Ie,x as Me,y as Be,z as Fe,B as je,C as Se,D as Z,E as Ge,R as x,N as Re,G as Ue,H as $,J as Oe,K as He,L as ze,M as qe,O as Ze}from"./vendor-1926fad9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}})();const Te="modulepreload",Ve=function(e,t){return new URL(e,t).href},W={},D=function(t,a,l){if(!a||a.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(a.map(r=>{if(r=Ve(r,l),r in W)return;W[r]=!0;const d=r.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(!!l)for(let u=s.length-1;u>=0;u--){const p=s[u];if(p.href===r&&(!d||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${c}`))return;const i=document.createElement("link");if(i.rel=d?"stylesheet":Te,d||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),d)return new Promise((u,p)=>{i.addEventListener("load",u),i.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t()).catch(r=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r})},We=f('<span class="loading loading-spinner">'),Je=f("<button>"),J=e=>{const[t,a]=we(e,["class","loading"]);return(()=>{const l=Je();return be(l,$e({get class(){return _("btn",t.loading?"btn-disabled":t.class)}},a),!1,!0),m(l,o(k,{get when(){return t.loading},get children(){return We()}}),null),m(l,()=>e.children,null),l})()},Ae=["light","dark","cupcake","bumblebee","emerald","corporate","synthwave","retro","cyberpunk","valentine","halloween","garden","forest","aqua","lofi","pastel","fantasy","wireframe","black","luxury","dracula","cmyk","autumn","business","acid","lemonade","night","coffee","winter"];var v=(e=>(e.Overview="/overview",e.Proxies="/proxies",e.Proxyprovider="/proxyprovider",e.Rules="/rules",e.Conns="/conns",e.Log="/logs",e.Config="/config",e))(v||{}),T=(e=>(e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.MEDIUM=200]="MEDIUM",e[e.HIGH=500]="HIGH",e))(T||{}),se=(e=>(e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.MEDIUM=800]="MEDIUM",e[e.HIGH=1500]="HIGH",e))(se||{}),ne=(e=>(e.OFF="off",e.DOTS="dots",e.BAR="bar",e.Auto="auto",e))(ne||{}),ae=(e=>(e.NATURAL="orderNatural",e.LATENCY_ASC="orderLatency_asc",e.LATENCY_DESC="orderLatency_desc",e.NAME_ASC="orderName_asc",e.NAME_DESC="orderName_desc",e))(ae||{}),C=(e=>(e.EN="en-US",e.ZH="zh-CN",e))(C||{}),le=(e=>(e.Close="close",e.ID="ID",e.Type="type",e.Process="process",e.Host="host",e.Rule="rules",e.Chains="chains",e.DlSpeed="dlSpeed",e.ULSpeed="ulSpeed",e.Download="dl",e.Upload="ul",e.Source="source",e.Destination="destination",e))(le||{});const Ee=Object.values(le),Ht={...Object.fromEntries(Ee.map(e=>[e,!0])),ID:!1},[zt,qt]=y(g(ne.Auto),{name:"proxiesPreviewType",storage:localStorage}),[Zt,Tt]=y(g(ae.NATURAL),{name:"proxiesSortingType",storage:localStorage}),[ie,Vt]=y(g("https://www.gstatic.com/generate_204"),{name:"urlForDelayTest",storage:localStorage}),[Qe,Wt]=y(g(!1),{name:"autoCloseConns",storage:localStorage}),[Xe,Jt]=y(g(!1),{name:"autoSwitchTheme",storage:localStorage}),[Ke,At]=y(g("light"),{name:"favDayTheme",storage:localStorage}),[Ye,Et]=y(g("night"),{name:"favNightTheme",storage:localStorage}),[ce,Qt]=y(g(!0),{name:"renderInTwoColumn",storage:localStorage}),et=()=>ie().startsWith("https"),A=()=>et()?se:T,de=e=>{Xe()&&z(e?Ye():Ke())},tt=()=>de(window.matchMedia("(prefers-color-scheme: dark)").matches),rt=()=>{tt(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>de(e.matches))},[E,Q]=g([]),[X,ot]=g([]),[O,K]=g({}),[Y,st]=g({}),S=()=>{const e=ue(),t=n=>{n.forEach(i=>{var p;const u=((p=i.history.at(-1))==null?void 0:p.delay)??0;st({...Y(),[i.name]:{udp:i.udp,type:i.type,name:i.name}}),K({...O(),[i.name]:u})})},a=async()=>{const{providers:n}=await e.get("providers/proxies").json();Object.values(n).forEach(p=>{t(p.proxies)}),ot(Object.values(n).filter(p=>p.name!=="default"&&p.vehicleType!=="Compatible"));const{proxies:i}=await e.get("proxies").json(),u=[...i.GLOBAL.all??[],"GLOBAL"];t(Object.values(i)),Q(Object.values(i).filter(p=>{var h;return(h=p.all)==null?void 0:h.length}).sort((p,h)=>u.indexOf(p.name)-u.indexOf(h.name)))};return{proxies:E,proxyProviders:X,delayTestByProxyGroupName:async n=>{const i=await e.get(`group/${n}/delay`,{searchParams:{url:ie(),timeout:2e3}}).json();K({...O(),...i})},delayMap:O,proxyNodeMap:Y,updateProxy:a,setProxyGroupByProxyName:async(n,i)=>{const u=E().slice(),p=u.find(h=>h.name===n.name);Qe()&&e.delete("connections"),await e.put(`proxies/${n.name}`,{body:JSON.stringify({name:i})}),p.now=i,Q(u)},updateProviderByProviderName:async n=>{try{await e.put(`providers/proxies/${n}`)}catch{}await a()},updateAllProvider:async()=>{await Promise.all(X().map(n=>e.put(`providers/proxies/${n.name}`))),await a()},healthCheckByProviderName:async n=>{await e.get(`providers/proxies/${n}/healthcheck`,{timeout:30*1e3}),await a()}}},[F,nt]=y(g(""),{name:"selectedEndpoint",storage:localStorage}),[at,Xt]=y(g([]),{name:"endpointList",storage:localStorage}),ue=()=>{const e=G();return De.create({prefixUrl:e==null?void 0:e.url,headers:{Authorization:e!=null&&e.secret?`Bearer ${e.secret}`:""}})},G=()=>at().find(({id:e})=>e===F()),Kt=()=>{var e;return(e=G())==null?void 0:e.secret},Yt=()=>{var e;return(e=G())==null?void 0:e.url.replace("http","ws")},B=ue(),er=()=>{const[e,t]=g([]),[a,l]=g([]),s=async()=>{const{rules:c}=await B.get("rules").json();t(Object.values(c));const{providers:n}=await B.get("providers/rules").json();l(Object.values(n))};return{rules:e,rulesProviders:a,updateRules:s,updateAllRuleProvider:async()=>{await Promise.all(a().map(c=>B.put(`providers/rules/${c.name}`))),await s()},updateRuleProviderByName:async c=>{await B.put(`providers/rules/${c}`),await s()}}},[lt,z]=y(g("halloween"),{name:"theme",storage:localStorage}),it=f('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),tr=e=>{const{title:t,content:a,onCollapse:l}=e,s=()=>{const c="collapse-open",n="collapse-close";return e.isOpen?c:n},r=()=>{const c="opacity-100",n="opacity-0";return e.isOpen?c:n},d=b(()=>ce()?"lg:grid-cols-3 xl:grid-cols-4":"sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7");return(()=>{const c=it(),n=c.firstChild,i=n.nextSibling;return n.$$click=()=>l(!e.isOpen),m(n,t),m(i,o(k,{get when(){return e.isOpen},children:a})),P(u=>{const p=_(s(),"collapse collapse-arrow mb-2 select-none overflow-visible border-secondary bg-base-200"),h=_(r(),d(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000");return p!==u._v$&&N(c,u._v$=p),h!==u._v$2&&N(i,u._v$2=h),u},{_v$:void 0,_v$2:void 0}),c})()};q(["click"]);const ct=f('<div class="ml-2 flex flex-1 flex-col">'),dt=f('<div class="flex"><div class="flex flex-1 flex-col">'),[ut,pe]=g(0);var ee;pe((ee=document==null?void 0:document.body)==null?void 0:ee.clientWidth);window.addEventListener("resize",()=>{pe(document.body.clientWidth)});const rr=e=>{const t=b(()=>ut()>=640&&ce()),a=b(()=>e.subChild.filter((s,r)=>r%2===0||!t())),l=b(()=>e.subChild.filter((s,r)=>r%2===1));return(()=>{const s=dt(),r=s.firstChild;return m(r,a),m(s,o(k,{get when(){return t()},get children(){const d=ct();return m(d,l),d}}),null),s})()},pt=f('<li class="tooltip tooltip-bottom">'),mt=f('<div class="drawer drawer-end w-auto sm:ml-auto"><input id="themes" type="checkbox" class="drawer-toggle"><div class="drawer-content flex items-center"><label for="themes" class="btn btn-circle btn-primary drawer-button btn-sm"></label></div><div class="drawer-side"><label for="themes" class="drawer-overlay"></label><ul class="menu rounded-l-box gap-2 bg-base-300 p-2 shadow">'),ht=f('<li class="btn btn-xs">'),gt=f('<div class="navbar-center hidden lg:flex"><ul class="menu menu-horizontal gap-2">'),vt=f('<ul class="navbar rounded-box sticky inset-x-0 top-2 z-10 mx-2 mt-2 flex w-auto items-center justify-center bg-base-300 px-4"><div class="navbar-start gap-4"><div><input id="navs" type="checkbox" class="drawer-toggle"><div class="drawer-content flex items-center"><label for="navs" class="btn btn-circle drawer-button btn-sm"></label></div><div class="drawer-side"><label for="navs" class="drawer-overlay"></label><ul class="menu rounded-r-box min-h-full w-2/5 gap-2 bg-base-300 pt-20 shadow"></ul></div></div><a class="text-xl font-bold normal-case" href="https://github.com/metacubex/metacubexd" target="_blank">metacubexd</a></div><div class="navbar-end"><div class="flex items-center gap-2">'),ft=f("<li>"),yt=({href:e,tooltip:t,children:a})=>(()=>{const l=pt();return j(l,"data-tip",t),m(l,o(oe,{class:"rounded-box",href:e,children:a})),l})(),xt=()=>(()=>{const e=mt(),t=e.firstChild,a=t.nextSibling,l=a.firstChild,s=a.nextSibling,r=s.firstChild,d=r.nextSibling;return m(l,o(ke,{})),m(d,o(H,{each:Ae,children:c=>(()=>{const n=ht();return n.$$click=()=>z(c),j(n,"data-theme",c),m(n,c),n})()})),e})(),wt=()=>{const[e,{locale:t}]=te(),{proxyProviders:a}=S(),l=b(()=>{const i=[{href:v.Overview,name:e("overview"),icon:o(Le,{})},{href:v.Proxies,name:e("proxies"),icon:o(Ie,{})},{href:v.Rules,name:e("rules"),icon:o(Me,{})},{href:v.Conns,name:e("connections"),icon:o(Be,{})},{href:v.Log,name:e("logs"),icon:o(Fe,{})},{href:v.Config,name:e("config"),icon:o(je,{})}];return a().length>0&&i.splice(2,0,{href:v.Proxyprovider,name:e("proxyProviders"),icon:o(Se,{})}),i}),s=Ce(),r=re(),[d,c]=g(!1),n=()=>{nt(""),r("/setup")};return(()=>{const i=vt(),u=i.firstChild,p=u.firstChild,h=p.firstChild,L=h.nextSibling,M=L.firstChild,ge=L.nextSibling,ve=ge.firstChild,fe=ve.nextSibling,V=u.nextSibling,R=V.firstChild;return h.addEventListener("change",w=>c(w.target.checked)),m(M,o(_e,{})),m(fe,o(H,{get each(){return l()},children:({href:w,name:U})=>(()=>{const I=ft();return I.$$click=()=>c(!1),m(I,o(oe,{href:w,children:U})),I})()})),m(i,o(k,{get when(){return s.pathname!=="/setup"},get children(){const w=gt(),U=w.firstChild;return m(U,o(H,{get each(){return l()},children:({href:I,name:ye,icon:xe})=>o(yt,{href:I,tooltip:ye,children:xe})})),w}}),V),m(R,o(J,{class:"btn-circle btn-sm",onClick:()=>{const w=t();t(w===C.EN?C.ZH:C.EN)},get children(){return o(Pe,{})}}),null),m(R,o(xt,{}),null),m(R,o(J,{class:"btn-circle btn-secondary btn-sm",onClick:n,get children(){return o(Ne,{})}}),null),P(()=>N(p,_("drawer w-auto lg:hidden",""))),P(()=>h.checked=d()),i})()};q(["click"]);const bt=f("<span>ms"),$t=e=>{const{delayMap:t}=S(),[a,l]=g(""),s=b(()=>t()[e.name]);return Z(()=>{l("text-success"),s()>A().HIGH?l("text-error"):s()>A().MEDIUM&&l("text-warning")}),o(k,{get when(){return b(()=>typeof s()=="number")()&&s()!==T.NOT_CONNECTED},get children(){const r=bt(),d=r.firstChild;return m(r,s,d),P(()=>N(r,a())),r}})},Dt=f('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),or=e=>{const{proxyName:t,isSelected:a,onClick:l}=e,{proxyNodeMap:s}=S(),r=b(()=>s()[t]),d=(c="")=>{const n=c.toLowerCase();return n.includes("shadowsocks")?n.replace("shadowsocks","ss"):n};return(()=>{const c=Dt(),n=c.firstChild,i=n.nextSibling,u=i.firstChild,p=u.nextSibling;return c.$$click=()=>l==null?void 0:l(),j(c,"data-tip",t),m(n,t),m(u,()=>{var h;return d((h=r())==null?void 0:h.type)},null),m(u,()=>{var h;return((h=r())==null?void 0:h.udp)&&" :: udp"},null),m(p,o($t,{get name(){return e.proxyName}})),P(h=>{const L=_("card card-bordered tooltip-bottom card-compact flex gap-1 border-neutral-focus bg-neutral p-3 text-neutral-content sm:tooltip",a&&"border-primary bg-primary-content text-primary",l&&"cursor-pointer"),M=_("truncate text-xs text-slate-500",a&&"text-primary");return L!==h._v$&&N(c,h._v$=L),M!==h._v$2&&N(u,h._v$2=M),h},{_v$:void 0,_v$2:void 0}),c})()};q(["click"]);const Ct=f('<div class="relative flex h-screen flex-col subpixel-antialiased"><div class="flex-1 overflow-y-auto overflow-x-hidden p-2 sm:p-4">'),_t=$(()=>D(()=>import("./Setup-a6b76ca5.js"),["./Setup-a6b76ca5.js","./vendor-1926fad9.js","./index-7f9e96e6.js"],import.meta.url)),Pt=$(()=>D(()=>import("./Overview-9596f61d.js"),["./Overview-9596f61d.js","./vendor-1926fad9.js","./index-67269be7.js"],import.meta.url)),Nt=$(()=>D(()=>import("./Connections-bf4fb00e.js"),["./Connections-bf4fb00e.js","./vendor-1926fad9.js","./index-67269be7.js","./index-57053789.js"],import.meta.url)),kt=$(()=>D(()=>import("./Logs-efcbcb5d.js"),["./Logs-efcbcb5d.js","./vendor-1926fad9.js","./index-67269be7.js","./index-57053789.js"],import.meta.url)),Lt=$(()=>D(()=>import("./Proxies-7e137790.js"),["./Proxies-7e137790.js","./vendor-1926fad9.js","./ProxyPreviewDots-362941c8.js","./proxies-575a9e23.js"],import.meta.url)),It=$(()=>D(()=>import("./ProxyProvider-d217eabc.js"),["./ProxyProvider-d217eabc.js","./vendor-1926fad9.js","./ProxyPreviewDots-362941c8.js","./proxies-575a9e23.js"],import.meta.url)),Mt=$(()=>D(()=>import("./Rules-4010af68.js"),["./Rules-4010af68.js","./vendor-1926fad9.js","./proxies-575a9e23.js"],import.meta.url)),Bt=$(()=>D(()=>import("./Config-9940eb1e.js"),["./Config-9940eb1e.js","./vendor-1926fad9.js","./index-7f9e96e6.js"],import.meta.url)),Ft=()=>{const e=re();return rt(),Z(()=>{F()&&G()&&S().updateProxy()}),Ge(async()=>{F()||e("/setup")}),(()=>{const t=Ct(),a=t.firstChild;return m(t,o(wt,{}),a),m(a,o(Ue,{get children(){return[o(k,{get when(){return F()},get children(){return[o(x,{get path(){return v.Overview},component:Pt}),o(x,{get path(){return v.Proxies},component:Lt}),o(x,{get path(){return v.Proxyprovider},component:It}),o(x,{get path(){return v.Rules},component:Mt}),o(x,{get path(){return v.Conns},component:Nt}),o(x,{get path(){return v.Log},component:kt}),o(x,{get path(){return v.Config},component:Bt}),o(x,{path:"*",get element(){return o(Re,{get href(){return v.Overview}})}})]}}),o(x,{path:"/setup",component:_t})]}})),P(()=>j(t,"data-theme",lt())),t})()},jt={add:"Add",overview:"Overview",proxies:"Proxies",rules:"Rules",connections:"Connections",logs:"Logs",config:"Config",upload:"Upload",download:"Download",uploadTotal:"Upload Total",downloadTotal:"Download Total",activeConnections:"Active Connections",memoryUsage:"Memory Usage",traffic:"Traffic",memory:"Memory",down:"Down",up:"Up",proxyProviders:"Proxy Providers",ruleProviders:"Rule Providers",search:"Search",ID:"ID",type:"Type",name:"Name",process:"Process",host:"Host",chains:"Chains",dlSpeed:"DL Speed",ulSpeed:"UL Speed",dl:"DL",ul:"UL",source:"Source",destination:"Destination",close:"Close",reset:"Reset",dnsQuery:"DNS Query",dots:"Dots",bar:"Bar",auto:"Auto",off:"Off",proxiesPreviewType:"Proxies preview type",urlForDelayTest:"Url for delay test",autoCloseConns:"Automatically close all connections",autoSwitchTheme:"Automatically switch theme",favDayTheme:"Favorite light theme",favNightTheme:"Favorite dark theme",renderInTwoColumns:"Render Proxies in two columns",updateGEODatabases:"Update GEO Databases",restartCore:"Restart Core",upgradeCore:"Upgrade Core",proxiesSorting:"Proxies Sorting",orderNatural:"Original order in config file",orderLatency_asc:"By latency from low to high",orderLatency_desc:"By latency from high to low",orderName_asc:"By name alphabetically (A-Z)",orderName_desc:"By name alphabetically (Z-A)"},St={add:"添加",overview:"概览",proxies:"代理",rules:"规则",connections:"连接",logs:"日志",config:"配置",upload:"上传",download:"下载",uploadTotal:"上传总量",downloadTotal:"下载总量",activeConnections:"活动连接",memoryUsage:"内存使用情况",traffic:"流量",memory:"内存",down:"下载",up:"上传",proxyProviders:"代理提供者",ruleProviders:"规则提供者",search:"搜索",ID:"ID",type:"类型",name:"名字",process:"进程",host:"主机",chains:"链路",dlSpeed:"下载速度",ulSpeed:"上传速度",dl:"下载量",ul:"上传量",source:"源地址",destination:"目标地址",close:"关闭",reset:"重置",dnsQuery:"DNS 查询",dots:"点阵",bar:"条形",auto:"自适应",off:"关闭",proxiesPreviewType:"节点组预览样式",urlForDelayTest:"测速链接",autoCloseConns:"切换代理时自动断开全部连接",autoSwitchTheme:"自动切换主题",favDayTheme:"浅色主题偏好",favNightTheme:"深色主题偏好",renderInTwoColumns:"节点双列渲染",updateGEODatabases:"更新 GEO 数据库文件",restartCore:"重启核心",upgradeCore:"更新核心",proxiesSorting:"节点排序",orderNatural:"原配置文件中的排序",orderLatency_asc:"按延迟从低到高",orderLatency_desc:"按延迟从高到低",orderName_asc:"按名称字母排序 (A-Z)",orderName_desc:"按名称字母排序 (Z-A)"},me={[C.EN]:jt,[C.ZH]:St},he=()=>{const[e,t]=y(g(Reflect.has(me,navigator.language)?navigator.language:C.EN),{name:"lang",storage:localStorage});return{lang:e,setLang:t}},Gt=e=>{const{setLang:t}=he(),[a,{locale:l}]=te();return Z(()=>{t(l())}),e.children},Rt=e=>{const{lang:t}=he(),a=Oe(me,t());return o(He.Provider,{value:a,get children(){return o(Gt,{get children(){return e.children}})}})},Ut=document.getElementById("root");ze(()=>o(Rt,{get children(){return o(qe,{get source(){return Ze()},get children(){return o(Ft,{})}})}}),Ut);export{qt as A,J as B,Ee as C,ae as D,Tt as E,rr as F,Zt as G,Wt as H,Vt as I,ce as J,Qe as K,$t as L,ie as M,or as P,nt as a,Kt as b,Ht as c,le as d,at as e,S as f,tr as g,ne as h,et as i,T as j,se as k,A as l,er as m,Qt as n,Jt as o,zt as p,tt as q,Xe as r,Xt as s,At as t,ue as u,Ae as v,Yt as w,Ke as x,Et as y,Ye as z};
