import{af as ge,f as $,i as l,h as n,S as v,o as u,c as j,ag as me,j as G,F as le,n as re,t as L,b as V,C as he,p as $e,ah as X,ai as J,g as xe}from"./vendor-ef4bbf5e.js";import{B as H}from"./Button-b966495a.js";import{r as fe,P as pe,p as Y,m as B,n as z,o as _,L as ie,q as K,v as Z,i as be,w as ee}from"./index-07e95a83.js";import{u as F}from"./global-b3f10bfd.js";const ve=u('<div class="ml-2 flex flex-1 flex-col">'),_e=u('<div class="flex"><div class="flex flex-1 flex-col">'),te=e=>{const i=ge(),t=$(()=>i.width>=640&&fe()),o=$(()=>e.subChild.filter((c,g)=>g%2===0||!t())),a=$(()=>e.subChild.filter((c,g)=>g%2===1));return(()=>{const c=_e(),g=c.firstChild;return l(g,o),l(c,n(v,{get when(){return t()},get children(){const S=ve();return l(S,a),S}}),null),c})()},ne=e=>{const[i,t]=j(100),o=$(()=>e.proxyNames.slice(0,i()));return n(me,{get each(){return o()},get hasMore(){return o().length<e.proxyNames.length},next:()=>t(i()+30),children:a=>n(pe,{proxyName:a,get isSelected(){return e.now===a},get onClick(){return e.onClick&&(()=>{var c;return(c=e.onClick)==null?void 0:c.call(e,a)})}})})},se=e=>{const i=()=>Y()===B.OFF,t=$(()=>e.proxyNameList.length<=30),o=$(()=>{const c=Y();return c===B.BAR||c===B.Auto&&!t()}),a=$(()=>{const c=Y();return c===B.DOTS||c===B.Auto&&t()});return n(v,{get when(){return!i()},get children(){return[n(v,{get when(){return o()},get children(){return n(ye,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),n(v,{get when(){return a()},get children(){return n(Pe,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},we=u('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),ye=e=>{const{latencyMap:i}=z(),t=$(()=>e.proxyNameList.map(d=>i()[d])),o=$(()=>t().length),a=$(()=>t().filter(d=>d>_().NOT_CONNECTED&&d<=_().MEDIUM).length),c=$(()=>t().filter(d=>d>_().MEDIUM&&d<=_().HIGH).length),g=$(()=>t().filter(d=>d>_().HIGH).length),S=$(()=>t().filter(d=>d===_().NOT_CONNECTED).length);return(()=>{const d=we(),P=d.firstChild,M=P.firstChild,T=M.nextSibling,D=T.nextSibling,U=D.nextSibling;return l(d,n(ie,{get name(){return e.now}}),null),G(x=>{const k=`${a()*100/o()}%`,I=`${c()*100/o()}%`,E=`${g()*100/o()}%`,O=`${S()*100/o()}%`;return k!==x._v$&&((x._v$=k)!=null?M.style.setProperty("width",k):M.style.removeProperty("width")),I!==x._v$2&&((x._v$2=I)!=null?T.style.setProperty("width",I):T.style.removeProperty("width")),E!==x._v$3&&((x._v$3=E)!=null?D.style.setProperty("width",E):D.style.removeProperty("width")),O!==x._v$4&&((x._v$4=O)!=null?U.style.setProperty("width",O):U.style.removeProperty("width")),x},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()},Ce=u("<div>"),Ne=u('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),Se=e=>{let i=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===_().NOT_CONNECTED?i=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>_().HIGH?i=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>_().MEDIUM&&(i=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const t=Ce();return G(()=>re(t,L("m-1 h-4 w-4 rounded-full",i))),t})()},Pe=e=>{const{latencyMap:i}=z();return(()=>{const t=Ne(),o=t.firstChild;return l(o,n(le,{get each(){return e.proxyNameList.map(a=>[a,i()[a]])},children:([a,c])=>{const g=e.now===a;return n(Se,{latency:c,selected:g})}})),l(t,n(ie,{get name(){return e.now}}),null),t})()},Me=u('<progress class="progress" max="100">'),Te=u('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),ke=u('<div class="text-sm text-slate-500">Expire: <!> '),Ee=e=>{const i=V(e.Total,{units:"iec"}),t=V(e.Download+e.Upload,{units:"iec"}),o=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:i,used:t,percentage:o,expireStr:()=>e.Expire===0?"Null":he(e.Expire*1e3).format("YYYY-MM-DD")}},Le=e=>{if(!e.subscriptionInfo)return;const i=Ee(e.subscriptionInfo);return[(()=>{const t=Me();return G(()=>t.value=i.percentage),t})(),(()=>{const t=Te(),o=t.firstChild,a=o.nextSibling,c=a.nextSibling,g=c.nextSibling;return g.nextSibling,l(t,()=>`${i.used}`,o),l(t,()=>`${i.total}`,a),l(t,()=>i.percentage,g),t})(),(()=>{const t=ke(),o=t.firstChild,a=o.nextSibling;return a.nextSibling,l(t,()=>i.expireStr(),a),t})()]},De=u('<div class="flex items-center gap-2"><div class="tabs tabs-boxed gap-2">'),Ie=u('<div class="flex h-full flex-col gap-2"><div class="flex-1 overflow-y-auto">'),Oe=u('<button><span></span><div class="badge badge-sm">'),Be=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div>'),Ue=u('<div class="text-sm text-slate-500"> :: <!> '),Ae=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),He=u('<div class="text-sm text-slate-500"> ');var N=function(e){return e.proxyProviders="proxyProviders",e.proxies="proxies",e}(N||{});const Ye=()=>{const[e]=$e(),{proxies:i,setProxyGroupByProxyName:t,latencyTestByProxyGroupName:o,latencyMap:a,proxyProviders:c,updateProviderByProviderName:g,updateAllProvider:S,healthCheckByProviderName:d}=z(),{map:P,set:M}=F(),{map:T,setWithCallback:D}=F(),U=async(h,m)=>{t(h,m)},x=async(h,m)=>{h.stopPropagation(),D(m,()=>o(m))},{map:k,setWithCallback:I}=F(),{map:E,setWithCallback:O}=F(),[q,Q]=j(!1),ae=(h,m)=>{h.stopPropagation(),I(m,()=>d(m))},ce=(h,m)=>{h.stopPropagation(),O(m,()=>g(m))},oe=async h=>{h.stopPropagation(),Q(!0);try{await S()}catch{}Q(!1)},[A,de]=j(N.proxies),ue=()=>[{type:N.proxies,name:e("proxies"),count:i().length},{type:N.proxyProviders,name:e("proxyProviders"),count:c().length}];return(()=>{const h=Ie(),m=h.firstChild;return l(h,n(v,{get when(){return c().length>0},get children(){const s=De(),y=s.firstChild;return l(y,n(le,{get each(){return ue()},children:b=>(()=>{const w=Oe(),r=w.firstChild,f=r.nextSibling;return w.$$click=()=>de(b.type),l(r,()=>b.name),l(f,()=>b.count),G(()=>re(w,L(A()===b.type&&"tab-active","tab gap-2 px-2"))),w})()})),l(s,n(v,{get when(){return A()===N.proxyProviders},get children(){return n(H,{class:"btn btn-circle btn-sm",get disabled(){return q()},onClick:b=>oe(b),get children(){return n(X,{get class(){return L(q()&&"animate-spin text-success")}})}})}}),null),s}}),m),l(m,n(v,{get when(){return A()===N.proxyProviders},get children(){return n(te,{get subChild(){return c().map(s=>{const y=K(s.proxies.map(r=>r.name)??[],a(),Z()),b=[(()=>{const r=Be(),f=r.firstChild,p=f.firstChild,R=p.nextSibling,C=f.nextSibling;return l(p,()=>s.name),l(R,()=>s.proxies.length),l(C,n(H,{class:"btn btn-circle btn-sm mr-2",get disabled(){return E()[s.name]},onClick:W=>ce(W,s.name),get children(){return n(X,{get class(){return L(E()[s.name]&&"animate-spin text-success")}})}}),null),l(C,n(H,{class:"btn btn-circle btn-sm",get disabled(){return k()[s.name]},onClick:W=>ae(W,s.name),get children(){return n(J,{get class(){return L(k()[s.name]&&"animate-pulse text-success")}})}}),null),r})(),n(Le,{get subscriptionInfo(){return s.subscriptionInfo}}),(()=>{const r=Ue(),f=r.firstChild,p=f.nextSibling;return p.nextSibling,l(r,()=>s.vehicleType,f),l(r,()=>e("updated"),p),l(r,()=>be(s.updatedAt),null),r})(),n(v,{get when(){return!P()[s.name]},get children(){return n(se,{proxyNameList:y})}})],w=n(ne,{proxyNames:y});return n(ee,{get isOpen(){return P()[s.name]},title:b,content:w,onCollapse:r=>M(s.name,r)})})}})}}),null),l(m,n(v,{get when(){return A()===N.proxies},get children(){return n(te,{get subChild(){return i().map(s=>{const y=K(s.all??[],a(),Z()),b=[(()=>{const r=Ae(),f=r.firstChild,p=f.firstChild,R=p.nextSibling;return l(p,()=>s.name),l(R,()=>{var C;return(C=s.all)==null?void 0:C.length}),l(r,n(H,{class:"btn-circle btn-sm",get disabled(){return T()[s.name]},onClick:C=>x(C,s.name),get children(){return n(J,{get class(){return L(T()[s.name]&&"animate-pulse text-success")}})}}),null),r})(),(()=>{const r=He(),f=r.firstChild;return l(r,()=>s.type,f),l(r,()=>{var p;return((p=s.now)==null?void 0:p.length)>0&&` :: ${s.now}`},null),r})(),n(v,{get when(){return!P()[s.name]},get children(){return n(se,{proxyNameList:y,get now(){return s.now}})}})],w=n(ne,{proxyNames:y,get now(){return s.now},onClick:r=>{U(s,r)}});return n(ee,{get isOpen(){return P()[s.name]},title:b,content:w,onCollapse:r=>M(s.name,r)})})}})}}),null),h})()};xe(["click"]);export{Ye as default};
