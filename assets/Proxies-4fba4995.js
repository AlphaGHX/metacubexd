import{i as x,e as k,S as X,h as se,t as te,j as Z,d as ie,l as B,c as V,Q as ee,s as we,F as _e,u as Me,x as Ce,a7 as ce,a8 as Se}from"./vendor-48c5660e.js";import{I as De}from"./index-4e88c381.js";import{D as q}from"./enum-cbdb10ae.js";import{u as Ne}from"./index-7ff5154f.js";import{b as ue}from"./index-ac54fc13.js";const Oe=B('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),Te=r=>{const{title:$,content:a,onCollapse:d}=r,p=()=>{const b="collapse-open",h="collapse-close";return r.isOpen?b:h},g=()=>{const b="opacity-100",h="opacity-0";return r.isOpen?b:h};return(()=>{const b=Oe(),h=b.firstChild,o=h.nextSibling;return h.$$click=()=>d(!r.isOpen),x(h,$),x(o,k(X,{get when(){return r.isOpen},children:a})),se(i=>{const f=te(p(),"collapse collapse-arrow mb-2 overflow-visible border-secondary bg-base-200"),m=te(g(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return f!==i._v$&&Z(b,i._v$=f),m!==i._v$2&&Z(o,i._v$2=m),i},{_v$:void 0,_v$2:void 0}),b})()},de=Te;ie(["click"]);const ke=B('<div class="ml-2 flex flex-1 flex-col">'),Pe=B('<div class="flex"><div class="flex flex-1 flex-col">'),[Le,ge]=V(0);var pe;ge((pe=document==null?void 0:document.body)==null?void 0:pe.clientWidth);window.addEventListener("resize",()=>{ge(document.body.clientWidth)});const je=r=>{const $=ee(()=>Le()>=640),a=ee(()=>r.subChild.filter((p,g)=>g%2===0||!$())),d=ee(()=>r.subChild.filter((p,g)=>g%2===1));return(()=>{const p=Pe(),g=p.firstChild;return x(g,a),x(p,k(X,{get when(){return $()},get children(){const b=ke();return x(b,d),b}}),null),p})()},fe=je,[Ee,Be]=V([]),[Ye,He]=V([]),[re,he]=V({});function ae(){const r=Ne(),$=h=>{h.forEach(o=>{var i;he({...re(),[o.name]:{udp:o.udp,type:o.type,delay:((i=o.history.at(-1))==null?void 0:i.delay)??0,name:o.name}})})},a=async()=>{const{providers:h}=await r.get("providers/proxies").json();Object.values(h).forEach(f=>{$(f.proxies)}),He(Object.values(h).filter(f=>f.name!=="default"&&f.vehicleType!=="Compatible"));const{proxies:o}=await r.get("proxies").json(),i=[...o.GLOBAL.all??[],"GLOBAL"];$(Object.values(o)),Be(Object.values(o).filter(f=>{var m;return(m=f.all)==null?void 0:m.length}).sort((f,m)=>i.indexOf(f.name)-i.indexOf(m.name)))};return{proxies:Ee,proxyProviders:Ye,delayTestByProxyGroupName:async h=>{const o=await r.get(`group/${h}/delay`,{searchParams:{url:"https://www.gstatic.com/generate_204",timeout:2e3}}).json();Object.entries(o).forEach(([i,f])=>{he({...re(),[i]:{...re()[i],delay:f}})})},proxyNodeMap:re,updateProxy:a,setProxyGroupByProxyName:async(h,o)=>{await r.put(`proxies/${h.name}`,{body:JSON.stringify({name:o})}),await a()},updateProviderByProviderName:async h=>{await r.put(`providers/proxies/${h}`),await a()},healthCheckByProviderName:async h=>{await r.get(`providers/proxies/${h}/healthcheck`,{timeout:30*1e3}),await a()}}}const Ie=B("<span>ms"),We=B('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),Ae=r=>{const{proxyName:$,isSelected:a,onClick:d}=r,{proxyNodeMap:p}=ae(),g=ee(()=>p()[$]),b=o=>{if(typeof o!="number"||o===q.NOT_CONNECTED)return"";let i="text-success";return o>q.HIGH?i="text-error":o>q.MEDIUM&&(i="text-warning"),(()=>{const f=Ie(),m=f.firstChild;return Z(f,i),x(f,o,m),f})()},h=(o="")=>{const i=o.toLowerCase();return i.includes("shadowsocks")?i.replace("shadowsocks","ss"):i};return(()=>{const o=We(),i=o.firstChild,f=i.nextSibling,m=f.firstChild,W=m.nextSibling;return o.$$click=()=>d==null?void 0:d(),we(o,"data-tip",$),x(i,$),x(m,()=>{var w;return h((w=g())==null?void 0:w.type)},null),x(m,()=>{var w;return((w=g())==null?void 0:w.udp)&&" :: udp"},null),x(W,()=>{var w;return b((w=g())==null?void 0:w.delay)}),se(w=>{const _=te("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 border-neutral-focus bg-neutral p-3 text-neutral-content",a&&"border-primary bg-primary-content text-primary",d&&"cursor-pointer"),D=te("truncate text-xs text-slate-500",a&&"text-primary");return _!==w._v$&&Z(o,w._v$=_),D!==w._v$2&&Z(m,w._v$2=D),w},{_v$:void 0,_v$2:void 0}),o})()};ie(["click"]);const me=r=>{const[$,a]=V(30),d=ee(()=>r.proxies.slice(0,$()));return k(De,{get each(){return d()},get hasMore(){return d().length<r.proxies.length},next:()=>a($()+30),children:p=>k(Ae,{proxyName:p,get isSelected(){return r.now===p},onClick:()=>{var g;(g=r.onClick)==null||g.call(r,p)}})})},Ge=B("<div>"),Fe=B('<div class="flex w-full flex-wrap">'),Ue=r=>{let $=r.selected?"bg-white border-4 border-success":"bg-success";return typeof r.delay!="number"||r.delay===q.NOT_CONNECTED?$=r.selected?"bg-white border-4 border-neutral":"bg-neutral":r.delay>q.HIGH?$=r.selected?"bg-white border-4 border-error":"bg-error":r.delay>q.MEDIUM&&($=r.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const a=Ge();return se(()=>Z(a,te("m-1 h-4 w-4 rounded-full",$))),a})()},$e=r=>{const{proxyNodeMap:$}=ae();return(()=>{const a=Fe();return x(a,k(_e,{get each(){return r.proxyNameList.map(d=>$()[d])},children:d=>{const p=d==null?void 0:d.delay,g=r.now===d.name;return k(Ue,{delay:p,selected:g})}})),a})()};var ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ye(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var xe={exports:{}};(function(r,$){(function(a,d){r.exports=d()})(ve,function(){var a=1e3,d=6e4,p=36e5,g="millisecond",b="second",h="minute",o="hour",i="day",f="week",m="month",W="quarter",w="year",_="date",D="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,G={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var n=["th","st","nd","rd"],e=l%100;return"["+l+(n[(e-20)%10]||n[e]||n[0])+"]"}},P=function(l,n,e){var s=String(l);return!s||s.length>=n?l:""+Array(n+1-s.length).join(e)+l},N={s:P,z:function(l){var n=-l.utcOffset(),e=Math.abs(n),s=Math.floor(e/60),t=e%60;return(n<=0?"+":"-")+P(s,2,"0")+":"+P(t,2,"0")},m:function l(n,e){if(n.date()<e.date())return-l(e,n);var s=12*(e.year()-n.year())+(e.month()-n.month()),t=n.clone().add(s,m),c=e-t<0,u=n.clone().add(s+(c?-1:1),m);return+(-(s+(e-t)/(c?t-u:u-t))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:m,y:w,w:f,d:i,D:_,h:o,m:h,s:b,ms:g,Q:W}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},O="en",v={};v[O]=G;var Y=function(l){return l instanceof F},A=function l(n,e,s){var t;if(!n)return O;if(typeof n=="string"){var c=n.toLowerCase();v[c]&&(t=c),e&&(v[c]=e,t=c);var u=n.split("-");if(!t&&u.length>1)return l(u[0])}else{var M=n.name;v[M]=n,t=M}return!s&&t&&(O=t),t||!s&&O},S=function(l,n){if(Y(l))return l.clone();var e=typeof n=="object"?n:{};return e.date=l,e.args=arguments,new F(e)},y=N;y.l=A,y.i=Y,y.w=function(l,n){return S(l,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var F=function(){function l(e){this.$L=A(e.locale,null,!0),this.parse(e)}var n=l.prototype;return n.parse=function(e){this.$d=function(s){var t=s.date,c=s.utc;if(t===null)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var u=t.match(j);if(u){var M=u[2]-1||0,T=(u[7]||"0").substring(0,3);return c?new Date(Date.UTC(u[1],M,u[3]||1,u[4]||0,u[5]||0,u[6]||0,T)):new Date(u[1],M,u[3]||1,u[4]||0,u[5]||0,u[6]||0,T)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return y},n.isValid=function(){return this.$d.toString()!==D},n.isSame=function(e,s){var t=S(e);return this.startOf(s)<=t&&t<=this.endOf(s)},n.isAfter=function(e,s){return S(e)<this.startOf(s)},n.isBefore=function(e,s){return this.endOf(s)<S(e)},n.$g=function(e,s,t){return y.u(e)?this[s]:this.set(t,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,s){var t=this,c=!!y.u(s)||s,u=y.p(e),M=function(J,H){var U=y.w(t.$u?Date.UTC(t.$y,H,J):new Date(t.$y,H,J),t);return c?U:U.endOf(i)},T=function(J,H){return y.w(t.toDate()[J].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(H)),t)},L=this.$W,E=this.$M,I=this.$D,R="set"+(this.$u?"UTC":"");switch(u){case w:return c?M(1,0):M(31,11);case m:return c?M(1,E):M(0,E+1);case f:var z=this.$locale().weekStart||0,Q=(L<z?L+7:L)-z;return M(c?I-Q:I+(6-Q),E);case i:case _:return T(R+"Hours",0);case o:return T(R+"Minutes",1);case h:return T(R+"Seconds",2);case b:return T(R+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,s){var t,c=y.p(e),u="set"+(this.$u?"UTC":""),M=(t={},t[i]=u+"Date",t[_]=u+"Date",t[m]=u+"Month",t[w]=u+"FullYear",t[o]=u+"Hours",t[h]=u+"Minutes",t[b]=u+"Seconds",t[g]=u+"Milliseconds",t)[c],T=c===i?this.$D+(s-this.$W):s;if(c===m||c===w){var L=this.clone().set(_,1);L.$d[M](T),L.init(),this.$d=L.set(_,Math.min(this.$D,L.daysInMonth())).$d}else M&&this.$d[M](T);return this.init(),this},n.set=function(e,s){return this.clone().$set(e,s)},n.get=function(e){return this[y.p(e)]()},n.add=function(e,s){var t,c=this;e=Number(e);var u=y.p(s),M=function(E){var I=S(c);return y.w(I.date(I.date()+Math.round(E*e)),c)};if(u===m)return this.set(m,this.$M+e);if(u===w)return this.set(w,this.$y+e);if(u===i)return M(1);if(u===f)return M(7);var T=(t={},t[h]=d,t[o]=p,t[b]=a,t)[u]||1,L=this.$d.getTime()+e*T;return y.w(L,this)},n.subtract=function(e,s){return this.add(-1*e,s)},n.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||D;var c=e||"YYYY-MM-DDTHH:mm:ssZ",u=y.z(this),M=this.$H,T=this.$m,L=this.$M,E=t.weekdays,I=t.months,R=t.meridiem,z=function(H,U,K,ne){return H&&(H[U]||H(s,c))||K[U].slice(0,ne)},Q=function(H){return y.s(M%12||12,H,"0")},J=R||function(H,U,K){var ne=H<12?"AM":"PM";return K?ne.toLowerCase():ne};return c.replace(C,function(H,U){return U||function(K){switch(K){case"YY":return String(s.$y).slice(-2);case"YYYY":return y.s(s.$y,4,"0");case"M":return L+1;case"MM":return y.s(L+1,2,"0");case"MMM":return z(t.monthsShort,L,I,3);case"MMMM":return z(I,L);case"D":return s.$D;case"DD":return y.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return z(t.weekdaysMin,s.$W,E,2);case"ddd":return z(t.weekdaysShort,s.$W,E,3);case"dddd":return E[s.$W];case"H":return String(M);case"HH":return y.s(M,2,"0");case"h":return Q(1);case"hh":return Q(2);case"a":return J(M,T,!0);case"A":return J(M,T,!1);case"m":return String(T);case"mm":return y.s(T,2,"0");case"s":return String(s.$s);case"ss":return y.s(s.$s,2,"0");case"SSS":return y.s(s.$ms,3,"0");case"Z":return u}return null}(H)||u.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,s,t){var c,u=this,M=y.p(s),T=S(e),L=(T.utcOffset()-this.utcOffset())*d,E=this-T,I=function(){return y.m(u,T)};switch(M){case w:c=I()/12;break;case m:c=I();break;case W:c=I()/3;break;case f:c=(E-L)/6048e5;break;case i:c=(E-L)/864e5;break;case o:c=E/p;break;case h:c=E/d;break;case b:c=E/a;break;default:c=E}return t?c:y.a(c)},n.daysInMonth=function(){return this.endOf(m).$D},n.$locale=function(){return v[this.$L]},n.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),c=A(e,s,!0);return c&&(t.$L=c),t},n.clone=function(){return y.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},l}(),le=F.prototype;return S.prototype=le,[["$ms",g],["$s",b],["$m",h],["$H",o],["$W",i],["$M",m],["$y",w],["$D",_]].forEach(function(l){le[l[1]]=function(n){return this.$g(n,l[0],l[1])}}),S.extend=function(l,n){return l.$i||(l(n,F,S),l.$i=!0),S},S.locale=A,S.isDayjs=Y,S.unix=function(l){return S(1e3*l)},S.en=v[O],S.Ls=v,S.p={},S})})(xe);var ze=xe.exports;const oe=ye(ze),Je=B('<progress class="progress" max="100">'),Re=B('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Ze=B('<div class="text-sm text-slate-500">Expire: <!> '),qe=r=>{const $=ue(r.Total),a=ue(r.Download+r.Upload),d=((r.Download+r.Upload)/r.Total*100).toFixed(2);return{total:$,used:a,percentage:d,expireStr:()=>r.Expire===0?"Null":oe(r.Expire*1e3).format("YYYY-MM-DD")}},Ve=r=>{if(!r.subscriptionInfo)return;const $=qe(r.subscriptionInfo);return[(()=>{const a=Je();return se(()=>a.value=$.percentage),a})(),(()=>{const a=Re(),d=a.firstChild,p=d.nextSibling,g=p.nextSibling,b=g.nextSibling;return b.nextSibling,x(a,()=>`${$.used}`,d),x(a,()=>`${$.total}`,p),x(a,()=>$.percentage,b),a})(),(()=>{const a=Ze(),d=a.firstChild,p=d.nextSibling;return p.nextSibling,x(a,()=>$.expireStr(),p),a})()]};var be={exports:{}};(function(r,$){(function(a,d){r.exports=d()})(ve,function(){return function(a,d,p){a=a||{};var g=d.prototype,b={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function h(i,f,m,W){return g.fromToBase(i,f,m,W)}p.en.relativeTime=b,g.fromToBase=function(i,f,m,W,w){for(var _,D,j,C=m.$locale().relativeTime||b,G=a.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],P=G.length,N=0;N<P;N+=1){var O=G[N];O.d&&(_=W?p(i).diff(m,O.d,!0):m.diff(i,O.d,!0));var v=(a.rounding||Math.round)(Math.abs(_));if(j=_>0,v<=O.r||!O.r){v<=1&&N>0&&(O=G[N-1]);var Y=C[O.l];w&&(v=w(""+v)),D=typeof Y=="string"?Y.replace("%d",v):Y(v,f,O.l,j);break}}if(f)return D;var A=j?C.future:C.past;return typeof A=="function"?A(D):A.replace("%s",D)},g.to=function(i,f){return h(i,f,this,!0)},g.from=function(i,f){return h(i,f,this)};var o=function(i){return i.$u?p.utc():p()};g.toNow=function(i){return this.to(o(this),i)},g.fromNow=function(i){return this.from(o(this),i)}}})})(be);var Qe=be.exports;const Ke=ye(Qe);oe.extend(Ke);function Xe(r){return oe(r).fromNow()}const et=B('<div><h1 class="pb-4 text-lg font-semibold">'),tt=B('<div class="flex flex-col gap-2"><div><h1 class="pb-4 text-lg font-semibold">'),nt=B('<div class="mr-10 flex items-center justify-between"><span></span><button class="btn btn-circle btn-sm">'),rt=B('<div class="text-sm text-slate-500"> :: '),st=B('<div class="mr-10 flex items-center justify-between"><span></span><div><button class="btn btn-circle btn-sm mr-2"></button><button class="btn btn-circle btn-sm">'),it=B('<div class="text-sm text-slate-500"> :: Updated '),dt=()=>{const[r]=Me(),{proxies:$,proxyProviders:a,updateProxy:d,setProxyGroupByProxyName:p,delayTestByProxyGroupName:g,updateProviderByProviderName:b,healthCheckByProviderName:h}=ae(),[o,i]=V({});Ce(async()=>{await d()});const f=async(_,D)=>{p(_,D)},m=async(_,D)=>{const j=_.target;j.classList.add("animate-pulse"),_.stopPropagation(),await g(D),j.classList.remove("animate-pulse")},W=async(_,D)=>{const j=_.target;j.classList.add("animate-pulse"),_.stopPropagation(),await h(D),j.classList.remove("animate-pulse")},w=async(_,D)=>{const j=_.target;j.classList.add("animate-spin"),_.stopPropagation(),await b(D),j.classList.remove("animate-spin")};return(()=>{const _=tt(),D=_.firstChild,j=D.firstChild;return x(j,()=>r("proxies")),x(D,k(fe,{get subChild(){return $().map(C=>{const G=[(()=>{const N=nt(),O=N.firstChild,v=O.nextSibling;return x(O,()=>C.name),v.$$click=Y=>m(Y,C.name),x(v,k(ce,{})),N})(),(()=>{const N=rt(),O=N.firstChild;return x(N,()=>C.type,O),x(N,()=>C.now,null),N})(),k(X,{get when(){return!o()[`group-${C.name}`]},get children(){return k($e,{get proxyNameList(){return C.all??[]},get now(){return C.now}})}})],P=k(me,{get proxies(){return C.all},get now(){return C.now},onClick:N=>{f(C,N)}});return k(de,{get isOpen(){return o()[`group-${C.name}`]},title:G,content:P,onCollapse:N=>i({...o(),[`group-${C.name}`]:N})})})}}),null),x(_,k(X,{get when(){return a().length>0},get children(){const C=et(),G=C.firstChild;return x(G,()=>r("proxyProviders")),x(C,k(fe,{get subChild(){return a().map(P=>{const N=[(()=>{const v=st(),Y=v.firstChild,A=Y.nextSibling,S=A.firstChild,y=S.nextSibling;return x(Y,()=>P.name),S.$$click=F=>w(F,P.name),x(S,k(Se,{})),y.$$click=F=>W(F,P.name),x(y,k(ce,{})),v})(),k(Ve,{get subscriptionInfo(){return P.subscriptionInfo}}),(()=>{const v=it(),Y=v.firstChild;return x(v,()=>P.vehicleType,Y),x(v,()=>Xe(P.updatedAt),null),v})(),k(X,{get when(){return!o()[`provider-${P.name}`]},get children(){return k($e,{get proxyNameList(){return P.proxies.map(v=>v.name)??[]}})}})],O=k(me,{get proxies(){return P.proxies.map(v=>v.name)}});return k(de,{get isOpen(){return o()[`provider-${P.name}`]},title:N,content:O,onCollapse:v=>i({...o(),[`provider-${P.name}`]:v})})})}}),null),C}}),null),_})()};ie(["click"]);export{dt as default};
