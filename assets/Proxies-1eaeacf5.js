import{i as _,b as T,S as ne,f as re,t as Q,g as z,d as ae,h as E,c as K,O as pe,s as xe,F as se,v as _e,a5 as ce,a6 as we}from"./vendor-d5356dcc.js";import{I as Me}from"./index-f3629057.js";import{D as Z}from"./enum-cbdb10ae.js";import{u as Se}from"./index-f84e5ee6.js";import{b as ue}from"./index-ac54fc13.js";const Ce=E('<div><div class="collapse-title pr-4 text-xl font-medium after:!top-8"></div><div>'),De=r=>{const{title:p,content:i,onCollapse:f}=r,y=()=>{const w="collapse-open",d="collapse-close";return r.isOpen?w:d},b=()=>{const w="opacity-100",d="opacity-0";return r.isOpen?w:d};return(()=>{const w=Ce(),d=w.firstChild,o=d.nextSibling;return d.$$click=()=>f(!r.isOpen),_(d,p),_(o,T(ne,{get when(){return r.isOpen},children:i})),re(a=>{const h=Q(y(),"collapse collapse-arrow overflow-visible border-secondary bg-base-200"),m=Q(b(),"collapse-content grid auto-rows-min grid-cols-2 gap-2 transition-opacity duration-1000 lg:grid-cols-3 xl:grid-cols-4");return h!==a._v$&&z(w,a._v$=h),m!==a._v$2&&z(o,a._v$2=m),a},{_v$:void 0,_v$2:void 0}),w})()},de=De;ae(["click"]);const[Ne,Oe]=K([]),[ke,Te]=K([]),[te,fe]=K({});function ie(){const r=Se(),p=d=>{d.forEach(o=>{var a;fe({...te(),[o.name]:{udp:o.udp,type:o.type,delay:((a=o.history.at(-1))==null?void 0:a.delay)??0,name:o.name}})})},i=async()=>{const{providers:d}=await r.get("providers/proxies").json();Object.values(d).forEach(h=>{p(h.proxies)}),Te(Object.values(d).filter(h=>h.name!=="default"&&h.vehicleType!=="Compatible"));const{proxies:o}=await r.get("proxies").json(),a=[...o.GLOBAL.all??[],"GLOBAL"];p(Object.values(o)),Oe(Object.values(o).filter(h=>{var m;return(m=h.all)==null?void 0:m.length}).sort((h,m)=>a.indexOf(h.name)-a.indexOf(m.name)))};return{proxies:Ne,proxyProviders:ke,delayTestByProxyGroupName:async d=>{const o=await r.get(`group/${d}/delay`,{searchParams:{url:"https://www.gstatic.com/generate_204",timeout:2e3}}).json();Object.entries(o).forEach(([a,h])=>{fe({...te(),[a]:{...te()[a],delay:h}})})},proxyNodeMap:te,updateProxy:i,setProxyGroupByProxyName:async(d,o)=>{await r.put(`proxies/${d.name}`,{body:JSON.stringify({name:o})}),await i()},updateProviderByProviderName:async d=>{await r.put(`providers/proxies/${d}`),await i()},healthCheckByProviderName:async d=>{await r.get(`providers/proxies/${d}/healthcheck`,{timeout:30*1e3}),await i()}}}const Pe=E("<span>ms"),Le=E('<div><div class="truncate text-left"></div><div class="flex items-center justify-between gap-1"><div></div><div class="text-xs">'),je=r=>{const{proxyName:p,isSelected:i,onClick:f}=r,{proxyNodeMap:y}=ie(),b=pe(()=>y()[p]),w=o=>{if(typeof o!="number"||o===Z.NOT_CONNECTED)return"";let a="text-success";return o>Z.HIGH?a="text-error":o>Z.MEDIUM&&(a="text-warning"),(()=>{const h=Pe(),m=h.firstChild;return z(h,a),_(h,o,m),h})()},d=(o="")=>{const a=o.toLowerCase();return a.includes("shadowsocks")?a.replace("shadowsocks","ss"):a};return(()=>{const o=Le(),a=o.firstChild,h=a.nextSibling,m=h.firstChild,D=m.nextSibling;return o.$$click=()=>f==null?void 0:f(),xe(o,"data-tip",p),_(a,p),_(m,()=>{var $;return d(($=b())==null?void 0:$.type)},null),_(m,()=>{var $;return(($=b())==null?void 0:$.udp)&&" :: udp"},null),_(D,()=>{var $;return w(($=b())==null?void 0:$.delay)}),re($=>{const M=Q("card card-bordered tooltip tooltip-bottom card-compact flex gap-1 border-neutral-focus bg-neutral p-3 text-neutral-content",i&&"border-primary bg-primary-content text-primary",f&&"cursor-pointer"),H=Q("truncate text-xs text-slate-500",i&&"text-primary");return M!==$._v$&&z(o,$._v$=M),H!==$._v$2&&z(m,$._v$2=H),$},{_v$:void 0,_v$2:void 0}),o})()};ae(["click"]);const he=r=>{const[p,i]=K(30),f=pe(()=>r.proxies.slice(0,p()));return T(Me,{get each(){return f()},get hasMore(){return f().length<r.proxies.length},next:()=>i(p()+30),children:y=>T(je,{proxyName:y,get isSelected(){return r.now===y},onClick:()=>{var b;(b=r.onClick)==null||b.call(r,y)}})})},Be=E("<div>"),Ee=E('<div class="flex w-full flex-wrap">'),Ye=r=>{let p=r.selected?"bg-white border-4 border-success":"bg-success";return typeof r.delay!="number"||r.delay===Z.NOT_CONNECTED?p=r.selected?"bg-white border-4 border-neutral":"bg-neutral":r.delay>Z.HIGH?p=r.selected?"bg-white border-4 border-error":"bg-error":r.delay>Z.MEDIUM&&(p=r.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const i=Be();return re(()=>z(i,Q("m-1 h-4 w-4 rounded-full",p))),i})()},me=r=>{const{proxyNodeMap:p}=ie();return(()=>{const i=Ee();return _(i,T(se,{get each(){return r.proxyNameList.map(f=>p()[f])},children:f=>{const y=f==null?void 0:f.delay,b=r.now===f.name;return T(Ye,{delay:y,selected:b})}})),i})()};var ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ve(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ye={exports:{}};(function(r,p){(function(i,f){r.exports=f()})(ge,function(){var i=1e3,f=6e4,y=36e5,b="millisecond",w="second",d="minute",o="hour",a="day",h="week",m="month",D="quarter",$="year",M="date",H="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,U={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var n=["th","st","nd","rd"],e=l%100;return"["+l+(n[(e-20)%10]||n[e]||n[0])+"]"}},k=function(l,n,e){var s=String(l);return!s||s.length>=n?l:""+Array(n+1-s.length).join(e)+l},g={s:k,z:function(l){var n=-l.utcOffset(),e=Math.abs(n),s=Math.floor(e/60),t=e%60;return(n<=0?"+":"-")+k(s,2,"0")+":"+k(t,2,"0")},m:function l(n,e){if(n.date()<e.date())return-l(e,n);var s=12*(e.year()-n.year())+(e.month()-n.month()),t=n.clone().add(s,m),c=e-t<0,u=n.clone().add(s+(c?-1:1),m);return+(-(s+(e-t)/(c?t-u:u-t))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:m,y:$,w:h,d:a,D:M,h:o,m:d,s:w,ms:b,Q:D}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},S="en",L={};L[S]=U;var A=function(l){return l instanceof X},G=function l(n,e,s){var t;if(!n)return S;if(typeof n=="string"){var c=n.toLowerCase();L[c]&&(t=c),e&&(L[c]=e,t=c);var u=n.split("-");if(!t&&u.length>1)return l(u[0])}else{var x=n.name;L[x]=n,t=x}return!s&&t&&(S=t),t||!s&&S},C=function(l,n){if(A(l))return l.clone();var e=typeof n=="object"?n:{};return e.date=l,e.args=arguments,new X(e)},v=g;v.l=G,v.i=A,v.w=function(l,n){return C(l,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var X=function(){function l(e){this.$L=G(e.locale,null,!0),this.parse(e)}var n=l.prototype;return n.parse=function(e){this.$d=function(s){var t=s.date,c=s.utc;if(t===null)return new Date(NaN);if(v.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var u=t.match(N);if(u){var x=u[2]-1||0,O=(u[7]||"0").substring(0,3);return c?new Date(Date.UTC(u[1],x,u[3]||1,u[4]||0,u[5]||0,u[6]||0,O)):new Date(u[1],x,u[3]||1,u[4]||0,u[5]||0,u[6]||0,O)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return v},n.isValid=function(){return this.$d.toString()!==H},n.isSame=function(e,s){var t=C(e);return this.startOf(s)<=t&&t<=this.endOf(s)},n.isAfter=function(e,s){return C(e)<this.startOf(s)},n.isBefore=function(e,s){return this.endOf(s)<C(e)},n.$g=function(e,s,t){return v.u(e)?this[s]:this.set(t,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,s){var t=this,c=!!v.u(s)||s,u=v.p(e),x=function(J,Y){var F=v.w(t.$u?Date.UTC(t.$y,Y,J):new Date(t.$y,Y,J),t);return c?F:F.endOf(a)},O=function(J,Y){return v.w(t.toDate()[J].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(Y)),t)},j=this.$W,B=this.$M,I=this.$D,R="set"+(this.$u?"UTC":"");switch(u){case $:return c?x(1,0):x(31,11);case m:return c?x(1,B):x(0,B+1);case h:var W=this.$locale().weekStart||0,q=(j<W?j+7:j)-W;return x(c?I-q:I+(6-q),B);case a:case M:return O(R+"Hours",0);case o:return O(R+"Minutes",1);case d:return O(R+"Seconds",2);case w:return O(R+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,s){var t,c=v.p(e),u="set"+(this.$u?"UTC":""),x=(t={},t[a]=u+"Date",t[M]=u+"Date",t[m]=u+"Month",t[$]=u+"FullYear",t[o]=u+"Hours",t[d]=u+"Minutes",t[w]=u+"Seconds",t[b]=u+"Milliseconds",t)[c],O=c===a?this.$D+(s-this.$W):s;if(c===m||c===$){var j=this.clone().set(M,1);j.$d[x](O),j.init(),this.$d=j.set(M,Math.min(this.$D,j.daysInMonth())).$d}else x&&this.$d[x](O);return this.init(),this},n.set=function(e,s){return this.clone().$set(e,s)},n.get=function(e){return this[v.p(e)]()},n.add=function(e,s){var t,c=this;e=Number(e);var u=v.p(s),x=function(B){var I=C(c);return v.w(I.date(I.date()+Math.round(B*e)),c)};if(u===m)return this.set(m,this.$M+e);if(u===$)return this.set($,this.$y+e);if(u===a)return x(1);if(u===h)return x(7);var O=(t={},t[d]=f,t[o]=y,t[w]=i,t)[u]||1,j=this.$d.getTime()+e*O;return v.w(j,this)},n.subtract=function(e,s){return this.add(-1*e,s)},n.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||H;var c=e||"YYYY-MM-DDTHH:mm:ssZ",u=v.z(this),x=this.$H,O=this.$m,j=this.$M,B=t.weekdays,I=t.months,R=t.meridiem,W=function(Y,F,V,ee){return Y&&(Y[F]||Y(s,c))||V[F].slice(0,ee)},q=function(Y){return v.s(x%12||12,Y,"0")},J=R||function(Y,F,V){var ee=Y<12?"AM":"PM";return V?ee.toLowerCase():ee};return c.replace(P,function(Y,F){return F||function(V){switch(V){case"YY":return String(s.$y).slice(-2);case"YYYY":return v.s(s.$y,4,"0");case"M":return j+1;case"MM":return v.s(j+1,2,"0");case"MMM":return W(t.monthsShort,j,I,3);case"MMMM":return W(I,j);case"D":return s.$D;case"DD":return v.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return W(t.weekdaysMin,s.$W,B,2);case"ddd":return W(t.weekdaysShort,s.$W,B,3);case"dddd":return B[s.$W];case"H":return String(x);case"HH":return v.s(x,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return J(x,O,!0);case"A":return J(x,O,!1);case"m":return String(O);case"mm":return v.s(O,2,"0");case"s":return String(s.$s);case"ss":return v.s(s.$s,2,"0");case"SSS":return v.s(s.$ms,3,"0");case"Z":return u}return null}(Y)||u.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,s,t){var c,u=this,x=v.p(s),O=C(e),j=(O.utcOffset()-this.utcOffset())*f,B=this-O,I=function(){return v.m(u,O)};switch(x){case $:c=I()/12;break;case m:c=I();break;case D:c=I()/3;break;case h:c=(B-j)/6048e5;break;case a:c=(B-j)/864e5;break;case o:c=B/y;break;case d:c=B/f;break;case w:c=B/i;break;default:c=B}return t?c:v.a(c)},n.daysInMonth=function(){return this.endOf(m).$D},n.$locale=function(){return L[this.$L]},n.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),c=G(e,s,!0);return c&&(t.$L=c),t},n.clone=function(){return v.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},l}(),le=X.prototype;return C.prototype=le,[["$ms",b],["$s",w],["$m",d],["$H",o],["$W",a],["$M",m],["$y",$],["$D",M]].forEach(function(l){le[l[1]]=function(n){return this.$g(n,l[0],l[1])}}),C.extend=function(l,n){return l.$i||(l(n,X,C),l.$i=!0),C},C.locale=G,C.isDayjs=A,C.unix=function(l){return C(1e3*l)},C.en=L[S],C.Ls=L,C.p={},C})})(ye);var He=ye.exports;const oe=ve(He),Ie=E('<progress class="progress" max="100">'),Ae=E('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Ge=E('<div class="text-sm text-slate-500">Expire: <!> '),Ue=r=>{const p=ue(r.Total),i=ue(r.Download+r.Upload),f=((r.Download+r.Upload)/r.Total*100).toFixed(2);return{total:p,used:i,percentage:f,expireStr:()=>r.Expire===0?"Null":oe(r.Expire*1e3).format("YYYY-MM-DD")}},Fe=r=>{if(!r.subscriptionInfo)return;const p=Ue(r.subscriptionInfo);return[(()=>{const i=Ie();return re(()=>i.value=p.percentage),i})(),(()=>{const i=Ae(),f=i.firstChild,y=f.nextSibling,b=y.nextSibling,w=b.nextSibling;return w.nextSibling,_(i,()=>`${p.used}`,f),_(i,()=>`${p.total}`,y),_(i,()=>p.percentage,w),i})(),(()=>{const i=Ge(),f=i.firstChild,y=f.nextSibling;return y.nextSibling,_(i,()=>p.expireStr(),y),i})()]};var be={exports:{}};(function(r,p){(function(i,f){r.exports=f()})(ge,function(){return function(i,f,y){i=i||{};var b=f.prototype,w={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function d(a,h,m,D){return b.fromToBase(a,h,m,D)}y.en.relativeTime=w,b.fromToBase=function(a,h,m,D,$){for(var M,H,N,P=m.$locale().relativeTime||w,U=i.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],k=U.length,g=0;g<k;g+=1){var S=U[g];S.d&&(M=D?y(a).diff(m,S.d,!0):m.diff(a,S.d,!0));var L=(i.rounding||Math.round)(Math.abs(M));if(N=M>0,L<=S.r||!S.r){L<=1&&g>0&&(S=U[g-1]);var A=P[S.l];$&&(L=$(""+L)),H=typeof A=="string"?A.replace("%d",L):A(L,h,S.l,N);break}}if(h)return H;var G=N?P.future:P.past;return typeof G=="function"?G(H):G.replace("%s",H)},b.to=function(a,h){return d(a,h,this,!0)},b.from=function(a,h){return d(a,h,this)};var o=function(a){return a.$u?y.utc():y()};b.toNow=function(a){return this.to(o(this),a)},b.fromNow=function(a){return this.from(o(this),a)}}})})(be);var We=be.exports;const Je=ve(We);oe.extend(Je);function Re(r){return oe(r).fromNow()}const ze=E('<h1 class="pb-4 text-lg font-semibold">Proxy Providers'),Ze=E('<div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),qe=E('<div class="flex flex-col gap-4"><div><h1 class="pb-4 text-lg font-semibold">Proxies</h1><div class="grid grid-cols-1 gap-2 sm:grid-cols-2">'),Ve=E('<div class="mr-10 flex items-center justify-between"><span></span><button class="btn btn-circle btn-sm">'),Qe=E('<div class="text-sm text-slate-500"> :: '),$e=E("<div>"),Ke=E('<div class="mr-10 flex items-center justify-between"><span></span><div><button class="btn btn-circle btn-sm mr-2"></button><button class="btn btn-circle btn-sm">'),Xe=E('<div class="text-sm text-slate-500"> :: Updated '),at=()=>{const{proxies:r,proxyProviders:p,updateProxy:i,setProxyGroupByProxyName:f,delayTestByProxyGroupName:y,updateProviderByProviderName:b,healthCheckByProviderName:w}=ie(),[d,o]=K({});_e(async()=>{await i()});const a=async(D,$)=>{const M=D.target;M.classList.add("animate-pulse"),D.stopPropagation(),await y($),M.classList.remove("animate-pulse")},h=async(D,$)=>{const M=D.target;M.classList.add("animate-pulse"),D.stopPropagation(),await w($),M.classList.remove("animate-pulse")},m=async(D,$)=>{const M=D.target;M.classList.add("animate-spin"),D.stopPropagation(),await b($),M.classList.remove("animate-spin")};return(()=>{const D=qe(),$=D.firstChild,M=$.firstChild,H=M.nextSibling;return _(H,T(se,{get each(){return r()},children:N=>{const P=[(()=>{const k=Ve(),g=k.firstChild,S=g.nextSibling;return _(g,()=>N.name),S.$$click=L=>a(L,N.name),_(S,T(ce,{})),k})(),(()=>{const k=Qe(),g=k.firstChild;return _(k,()=>N.type,g),_(k,()=>N.now,null),k})(),T(ne,{get when(){return!d()[`group-${N.name}`]},get children(){return T(me,{get proxyNameList(){return N.all??[]},get now(){return N.now}})}})],U=T(he,{get proxies(){return N.all},get now(){return N.now},onClick:k=>{f(N,k)}});return(()=>{const k=$e();return _(k,T(de,{get isOpen(){return d()[`group-${N.name}`]},title:P,content:U,onCollapse:g=>o({...d(),[`group-${N.name}`]:g})})),k})()}})),_(D,T(ne,{get when(){return p().length>0},get children(){return[ze(),(()=>{const N=Ze();return _(N,T(se,{get each(){return p()},children:P=>{const U=[(()=>{const g=Ke(),S=g.firstChild,L=S.nextSibling,A=L.firstChild,G=A.nextSibling;return _(S,()=>P.name),A.$$click=C=>m(C,P.name),_(A,T(we,{})),G.$$click=C=>h(C,P.name),_(G,T(ce,{})),g})(),T(Fe,{get subscriptionInfo(){return P.subscriptionInfo}}),(()=>{const g=Xe(),S=g.firstChild;return _(g,()=>P.vehicleType,S),_(g,()=>Re(P.updatedAt),null),g})(),T(ne,{get when(){return!d()[`provider-${P.name}`]},get children(){return T(me,{get proxyNameList(){return P.proxies.map(g=>g.name)??[]}})}})],k=T(he,{get proxies(){return P.proxies.map(g=>g.name)}});return(()=>{const g=$e();return _(g,T(de,{get isOpen(){return d()[`provider-${P.name}`]},title:U,content:k,onCollapse:S=>o({...d(),[`provider-${P.name}`]:S})})),g})()}})),N})()]}}),null),D})()};ae(["click"]);export{at as default};
